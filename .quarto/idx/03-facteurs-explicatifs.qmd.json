{"title":"Facteurs explicatifs de la variable dépendante","markdown":{"yaml":{"title":"Facteurs explicatifs de la variable dépendante","subtitle":"Modèle linéaire (LM), validité et post-hoc"},"headingText":"Objectif du chapitre","containsRefs":false,"markdown":"\n\n::: callout-important\n\nIdentifier **quels facteurs** (groupe, variété, période) **expliquent** la variable dépendante *taille*, en testant les effets principaux et les interactions (un facteur ; deux facteurs avec ou sans interaction), puis en réalisant les comparaisons post-hoc en cas d'effets significatifs.\n:::\n\n# Objectif\n\nCe chapitre vise à **déterminer les facteurs qui peuvent expliquer la variable dépendante** (la hauteur des plantes). On distingue classiquement :\n\n-   **Un facteur** : on teste l'effet d'un seul facteur (ex. fertilisant, ou variété, ou période) sur la variable dépendante.\n-   **Deux facteurs avec ou sans interaction** : on teste les effets de deux facteurs (ex. fertilisant et variété, ou fertilisant et période) et leur interaction. Si l'interaction est significative, l'effet d'un facteur dépend du niveau de l'autre ; sinon, les effets principaux suffisent à interpréter les résultats.\n\nDans notre étude, la variable dépendante est la **hauteur** ; les facteurs sont le **fertilisant** (terreau : Ma, Ca, An), la **variété** (Var1, Var2) et la **période** (T1–T4). Les plantes sont toutes différentes (individus uniques), avec des mesures répétées dans le temps. On utilise un **modèle linéaire (LM)** à effets fixes : **fertilisant** (principal), **variété** (contrôle) et **période** ; chaque ligne des données correspond à une observation de hauteur.\n\n# Données et modèle linéaire (LM)\n\nLes mêmes données qu’au chapitre 2 sont chargées puis analysées avec un modèle **hauteur \\~ fertilisant × variété + Error(id / période)** : effets fixes *fertilisant* (3 terreaux), *variété* (2 variétés), *période* (T1–T4) et interactions ; effet aléatoire intercept par *plante* (id). Tous les sujets sont inclus.\n\n## Explication de ce qui est fait dans le modèle\n\nVoici, dans l'ordre, ce que fait le chapitre en utilisant **uniquement une ANOVA à mesures répétées avec `afex::aov_car`**.\n\n**1. Import et préparation des données**\n\n-   Lecture du fichier Excel `donnees/donnees.xlsx`.\n-   Variables utilisées : **groupe** (terreau Ma, Ca, An), **variete** (Var1, Var2), **periode** (T1–T4), **taille** (variable à expliquer).\n-   Conversion de `taille` en numérique en gérant les **virgules décimales**.\n-   Mise en facteur de `groupe`, `variete`, `periode` avec les bons niveaux.\n-   Création d’un identifiant **technique** `id` (une étiquette par ligne) pour définir la structure des **mesures répétées** dans le modèle (mais sans entrer comme facteur explicatif).\n\n**2. Modèle ANOVA à mesures répétées (afex::aov_car)**\n\n-   Le modèle est ajusté avec :\n    -   **Variable dépendante (dv)** : `taille`.\n    -   **Facteurs inter-sujets (between)** : `groupe` et `variete` (chaque observation appartient à une seule combinaison groupe × variété).\n    -   **Facteur intra-sujet (within)** : `periode` (mêmes plantes suivies à T1, T2, T3, T4).\n-   Formule utilisée :\\\n    \\[ \\text{taille} \\sim \\text{groupe} \\times \\text{variete} + \\text{Error(id / periode)} \\]\n-   `afex::aov_car` calcule une **ANOVA de type III** avec, pour chaque effet (groupe, variete, groupe×variete, etc.) :\n    -   les **sommes de carrés**,\n    -   le **F** de Fisher,\n    -   la **p-value**,\n    -   la **taille d’effet** ((\\eta\\^2) partiel, `pes`).\n\n**3. Sphéricité et corrections (Mauchly, GG, HF)**\n\n-   `summary()` du modèle fournit :\n    -   le **test de Mauchly** de sphéricité pour les effets impliquant `periode`,\n    -   les **corrections de Greenhouse–Geisser (GG)** et **Huynh–Feldt (HF)** si la sphéricité n’est pas respectée.\n-   L’interprétation des effets de `periode` et des interactions avec `periode` se base sur ces p-values corrigées.\n\n**4. Vérifications des conditions de validité**\n\n-   **Normalité des résidus** : graphiques Q–Q et histogramme des résidus de l’ANOVA à mesures répétées.\n-   **Homogénéité des variances (Levene)** : test de Levene sur la **taille moyenne par combinaison groupe × variété × id**, afin de vérifier l’égalité des variances entre conditions.\n\n**5. Comparaisons post-hoc (emmeans)**\n\n-   **Moyennes marginales (groupe × variété)** : estimation des moyennes de `taille` pour chaque combinaison groupe–variété, avec erreurs standard et intervalles de confiance à 95 %.\n-   **Comparaisons deux à deux (Tukey)** :\n    -   Comparaisons entre toutes les combinaisons **groupe × variété** (effets globaux).\n    -   Comparaisons **par période** : mêmes contrastes, mais séparément pour T1, T2, T3, T4, pour repérer les périodes où les différences sont significatives.\n\n**Résumé** : cette ANOVA à mesures répétées teste si le **terreau** (`groupe`), la **variété** (`variete`) et la **période** (`periode`) – ainsi que leurs interactions – expliquent la **taille**, en respectant la structure de mesures répétées. Les diagnostics (normalité, Levene, sphéricité) justifient l’usage des tests F et des post-hoc de Tukey, qui permettent ensuite de conclure sur les conditions (terreau × variété, par période) donnant les tailles les plus élevées.\n\n```{r ch3-libs, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(emmeans)\nlibrary(car)\nif (!requireNamespace(\"afex\", quietly = TRUE)) install.packages(\"afex\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(afex)\nif (!requireNamespace(\"gtsummary\", quietly = TRUE)) install.packages(\"gtsummary\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(gtsummary)\nlibrary(knitr)\n```\n\n```{r ch3-import, error=TRUE}\n# --- Import : plan = mesures répétées T1–T4 pour Var1 et Var2, dans chaque fertilisant ---\nif (!requireNamespace(\"readxl\", quietly = TRUE)) install.packages(\"readxl\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(readxl)\nd <- read_excel(\"donnees/donnees.xlsx\")\n\nd$hauteur <- as.numeric(gsub(\",\", \".\", as.character(d$hauteur)))\nd <- d %>%\n  mutate(\n    periode     = factor(as.character(periode), levels = c(\"T1\", \"T2\", \"T3\", \"T4\")),\n    fertilisant = factor(fertilisant, levels = c(\"Ma\", \"Ca\", \"An\")),\n    variete     = factor(variete)\n  ) %>%\n  # Création d'identifiants \"sujets\" artificiels par (fertilisant, variete, rang)\n  # pour simuler des mesures répétées comme dans l'exemple DABIRE\n  group_by(fertilisant, variete, periode) %>%\n  arrange(fertilisant, variete, periode, .by_group = TRUE) %>%\n  mutate(rang = row_number()) %>%\n  ungroup() %>%\n  mutate(\n    id = interaction(fertilisant, variete, rang, drop = TRUE),\n    id = factor(id)\n  )\n```\n\n## Description du modèle utilisé\n\nLe modèle utilisé est une **ANOVA à mesures répétées** implémentée avec `afex::aov_car`. Chaque ligne du tableau correspond à **une observation de hauteur pour une combinaison (fertilisant, variété, période)**.\n\n| Élément | Description |\n|----|----|\n| **Variable dépendante** | `hauteur` (hauteur des plantes, quantitative) |\n| **Facteurs inter-sujets** | `fertilisant` (3 terreaux : Ma, Ca, An), `variete` (2 variétés) |\n| **Facteur intra-sujet** | `periode` (T1–T4, mesures répétées) |\n| **Identifiant (id)** | Étiquette technique construite par combinaison `(fertilisant, variete, rang)` pour regrouper artificiellement les mesures répétées dans `Error(id / periode)` |\n| **Formule** | `hauteur ~ fertilisant * variete + Error(id / periode)` |\n| **Options** | Type III ; corrections **Greenhouse–Geisser** / **Huynh–Feldt** pour les termes impliquant `periode` ; **η² partiel (pes)** comme taille d’effet |\n\n```{r aov-car, error=TRUE}\n# --- ANOVA à mesures répétées avec afex::aov_car -------------------------\n\n# On fixe le type de sommes de carrés à III (classique en présence d'interactions)\nafex::afex_options(type = 3)\n\n# Ajustement du modèle :\n# - hauteur : variable dépendante\n# - fertilisant * variete : effets fixes inter-sujets et leur interaction\n# - Error(id / periode) : structure de mesures répétées (effet de periode imbriqué dans id)\n# - na.rm = TRUE : les observations manquantes (périodes non observées pour certains individus)\n#   sont retirées de l'analyse, comme suggéré par le message d'erreur d'afex.\nanova_rm <- afex::aov_car(\n  hauteur ~ fertilisant * variete + Error(id / periode),\n  data  = d,\n  na.rm = TRUE\n)\n\n# Tableau ANOVA \"propre\" (nice) :\n# - fournit F, p-value, et η² partiel (pes) pour chaque effet\ntab_rm <- nice(anova_rm, es = \"pes\")\nknitr::kable(\n  tab_rm,\n  caption = \"ANOVA à mesures répétées (afex::aov_car) : effets de fertilisant, variété, période et interactions, avec η² partiel.\"\n)\n\n# Résumé complet du modèle :\n# - inclut le test de Mauchly (sphéricité)\n# - et les corrections GG / HF si nécessaire\nsummary(anova_rm)\n```\n\nEn résumé, la hauteur dépend significativement du **fertilisant** et de la **variété**, ainsi que de la **période** de mesure, avec une interaction significative entre **variété et période** ; les interactions impliquant le fertilisant ne sont pas significatives.\n\nLes tests de **Mauchly** ne sont pas significatifs, ce qui indique que l’hypothèse de sphéricité est raisonnable ; les corrections de Greenhouse–Geisser et Huynh–Feldt confirment la significativité de l’effet de la **période** et de l’interaction **variété × période**, tandis que les termes avec le fertilisant restent non significatifs.\n\n# Vérification des conditions de validité\n\n## Normalité des résidus\n\n```{r normalite, fig.cap=\"Graphique Q-Q et histogramme des résidus de l’ANOVA à mesures répétées.\", error=TRUE}\n# On extrait les résidus du modèle sous-jacent (lm) contenu dans l'objet afex\nres <- residuals(anova_rm$lm)\n\n# Affichage côte à côte :\n# - Q-Q plot : vérification de l'alignement des résidus sur la droite théorique\n# - Histogramme : forme globale (approximation gaussienne attendue)\npar(mfrow = c(1, 2))\nqqnorm(res, main = \"Q-Q des résidus\"); qqline(res)\nhist(res, breaks = 15, main = \"Distribution des résidus\", xlab = \"Résidus\")\npar(mfrow = c(1, 1))\n\n# Test formel de normalité (Shapiro-Wilk)\nshapiro_res <- shapiro.test(res)\nshapiro_res\n```\n\nLes graphes de résidus indiquent une distribution globalement symétrique et proche d’une droite normale, mais le test de Shapiro–Wilk est significatif (p-value très petite), ce qui met en évidence une déviation statistique de la normalité ; compte tenu de la taille d’échantillon et de l’homogénéité des variances, l’ANOVA reste toutefois utilisable avec prudence.\n\n## Homogénéité des variances (Levene)\n\nLe test de Levene est réalisé sur la **hauteur moyenne par combinaison (id, fertilisant, variete)**, ce qui revient à comparer les variances entre conditions expérimentales (fertilisant × variété), indépendamment de la période.\n\n```{r levene, error=TRUE, warning=FALSE}\n# Agrégation : moyenne de hauteur par id, fertilisant, variété\nd_mean <- d %>%\n  group_by(id, fertilisant, variete) %>%\n  summarise(hauteur_moy = mean(hauteur, na.rm = TRUE), .groups = \"drop\")\n\n# Test de Levene sur les variances de hauteur moyenne entre combinaisons fertilisant × variété\nlev <- car::leveneTest(hauteur_moy ~ fertilisant * variete, data = d_mean)\n\n# Mise en forme d'un tableau lisible\nlev_df <- as.data.frame(lev)\nlev_df <- cbind(Source = rownames(lev_df), lev_df)\nrownames(lev_df) <- NULL\nnames(lev_df) <- c(\"Source\", \"Ddl\", \"F\", \"p-value\")\nlev_df[[\"p-value\"]] <- ifelse(is.na(lev_df[[\"p-value\"]]), \"—\", format.pval(lev_df[[\"p-value\"]], digits = 3))\nlev_df[[\"F\"]] <- ifelse(is.na(lev_df[[\"F\"]]), \"—\", format(round(lev_df[[\"F\"]], 4), nsmall = 4))\nlev_df[is.na(lev_df)] <- \"—\"\n\nknitr::kable(\n  lev_df,\n  align = c(\"l\", \"r\", \"r\", \"r\"),\n  caption = \"Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété).\"\n)\n```\n\nLe test de Levene n’étant pas significatif, on peut considérer que les variances de hauteur sont similaires entre les combinaisons de fertilisant et de variété.\n\n# Comparaisons post-hoc\n\n# Comparaisons post-hoc\n\nLorsque des effets ou interactions sont significatifs, les comparaisons deux à deux (Tukey) permettent d’identifier les combinaisons **groupe × variété** et les **périodes** dont les moyennes diffèrent significativement.\n\n## Moyennes marginales (fertilisant × variété)\n\n```{r emm-marginal, error=TRUE}\n# Moyennes marginales (effet global de fertilisant × variété, toutes périodes confondues)\nemm_gv <- emmeans(anova_rm, ~ fertilisant * variete)\n\n# Extraction sous forme de data.frame et arrondi pour la présentation\nemm_gv_df <- summary(emm_gv) %>% as.data.frame()\nemm_gv_df <- emm_gv_df %>%\n  mutate(\n    emmean   = round(emmean, 2),\n    SE       = round(SE, 3),\n    lower.CL = round(lower.CL, 2),\n    upper.CL = round(upper.CL, 2)\n  )\n\nnames(emm_gv_df) <- c(\"Fertilisant\", \"Variété\", \"Moyenne\", \"ESM\", \"Ddl\", \"IC inf.\", \"IC sup.\")\n\nknitr::kable(\n  emm_gv_df[, c(\"Fertilisant\", \"Variété\", \"Moyenne\", \"ESM\", \"IC inf.\", \"IC sup.\")],\n  align = c(\"l\", \"l\", \"r\", \"r\", \"r\", \"r\"),\n  caption = \"Moyennes marginales (et IC 95 %) pour fertilisant × variété (toutes périodes confondues).\"\n)\n```\n\nCes moyennes montrent que, en moyenne sur toutes les périodes, la variété 2 produit des plantes plus hautes que la variété 1 pour un même fertilisant, avec des valeurs maximales observées pour les combinaisons `Ca–Var2` et `Ma–Var2`.\n\n## Comparaisons deux à deux : fertilisant × variété (Tukey)\n\n```{r posthoc-gv, error=TRUE}\n# Comparaisons toutes paires de combinaisons fertilisant × variété (corrigées de Tukey)\nph_gv <- pairs(emm_gv, adjust = \"tukey\") %>% as.data.frame()\npval <- ph_gv$p.value\n\nph_gv <- ph_gv %>%\n  mutate(\n    estimate = round(estimate, 3),\n    SE       = round(SE, 3),\n    t.ratio  = round(t.ratio, 2),\n    signif   = case_when(\n      pval < 0.001 ~ \"***\",\n      pval < 0.01  ~ \"**\",\n      pval < 0.05  ~ \"*\",\n      TRUE         ~ \"\"\n    ),\n    p.value = format.pval(p.value, digits = 3, eps = 0.001)\n  )\n\nnames(ph_gv) <- c(\"Contraste\", \"Différence\", \"ESM\", \"Ddl\", \"t\", \"p-value\", \"Signif.\")\n\nknitr::kable(\n  ph_gv,\n  align = c(\"l\", \"r\", \"r\", \"r\", \"r\", \"r\", \"c\"),\n  caption = \"Comparaisons post-hoc Tukey : fertilisant × variété (toutes périodes confondues). * p < 0,05 ; ** p < 0,01 ; *** p < 0,001.\"\n)\n```\n\nAprès correction de Tukey, seules les combinaisons `Ca–Var2` vs `Ma–Var1` et `Ca–Var2` vs `An–Var1` présentent des différences significatives de hauteur, ce qui confirme un avantage marqué de `Ca–Var2` par rapport à ces deux couples.\n\n## Comparaisons deux à deux par période (Tukey)\n\n```{r posthoc-periode, error=TRUE}\n# Effets de fertilisant × variété examinés séparément pour chaque période (T1, T2, T3, T4)\nemm_per <- emmeans(anova_rm, ~ fertilisant * variete | periode)\nph_per <- pairs(emm_per, adjust = \"tukey\") %>% as.data.frame()\npval_per <- ph_per$p.value\n\nph_per <- ph_per %>%\n  mutate(\n    estimate = round(estimate, 3),\n    SE       = round(SE, 3),\n    t.ratio  = round(t.ratio, 2),\n    signif   = case_when(\n      pval_per < 0.001 ~ \"***\",\n      pval_per < 0.01  ~ \"**\",\n      pval_per < 0.05  ~ \"*\",\n      TRUE             ~ \"\"\n    ),\n    p.value = format.pval(p.value, digits = 3, eps = 0.001)\n  )\n\nnames(ph_per) <- c(\"Contraste\", \"Différence\", \"ESM\", \"Ddl\", \"t\", \"p-value\", \"Signif.\", \"Période\")\n\nknitr::kable(\n  ph_per[, c(\"Période\", \"Contraste\", \"Différence\", \"ESM\", \"t\", \"p-value\", \"Signif.\")],\n  align = c(\"l\", \"l\", \"r\", \"r\", \"r\", \"r\", \"c\"),\n  caption = \"Comparaisons post-hoc Tukey par période. * p < 0,05 ; ** p < 0,01 ; *** p < 0,001.\"\n)\n```\n\nÀ la période T1, plusieurs contrastes sont significatifs et indiquent un net avantage de la variété 2 pour certains fertilisants, alors qu’aux périodes T2, T3 et T4 aucune comparaison fertilisant × variété n’est significative, ce qui suggère un rapprochement des hauteurs entre combinaisons au fil du temps.\n\n# Modèles ANOVA à mesures répétées (structure type DABIRE)\n\nDans cette section, on implémente **exactement le même type de modèles** que dans le rapport de DABIRE (ANOVA par période, puis ANOVA à mesures répétées avec `car::Anova`), en utilisant directement les variables `fertilisant`, `variete`, `periode` et `hauteur` de la base.\n\n```{r dabire-libs, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(knitr)\nif (!requireNamespace(\"nortest\", quietly = TRUE)) install.packages(\"nortest\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(nortest)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(car)\n```\n\n```{r dabire-import, error=TRUE}\n# Import des mêmes données que précédemment\nd2 <- read_excel(\"donnees/donnees.xlsx\")\n\n# Conversion des virgules décimales en points et mise en forme des facteurs\nd2$hauteur <- as.numeric(gsub(\",\", \".\", as.character(d2$hauteur)))\n\nd2 <- d2 %>%\n  mutate(\n    fertilisant = factor(fertilisant),               # Ma, Ca, An\n    variete     = factor(variete),                   # Var1, Var2\n    periode     = factor(periode, levels = c(\"T1\",\"T2\",\"T3\",\"T4\"))\n  )\n```\n\n## Modélisation : ANOVA par période + modèle à mesures répétées\n\n```{r dabire-wide, error=TRUE}\n# Création d'IDs artificiels par (fertilisant, variete, periode)\nd2_id <- d2 %>%\n  group_by(fertilisant, variete, periode) %>%\n  arrange(No, .by_group = TRUE) %>%\n  mutate(rang = row_number()) %>%\n  ungroup() %>%\n  mutate(id = interaction(fertilisant, variete, rang, drop = TRUE))\n\n# Passage au format large : une ligne = un \"sujet\", colonnes t1..t4\nbase <- d2_id %>%\n  mutate(\n    periode_mesure = dplyr::recode(\n      as.character(periode),\n      \"T1\" = \"t1\",\n      \"T2\" = \"t2\",\n      \"T3\" = \"t3\",\n      \"T4\" = \"t4\"\n    )\n  ) %>%\n  select(id, fertilisant, variete, periode_mesure, hauteur) %>%\n  tidyr::pivot_wider(\n    names_from  = periode_mesure,\n    values_from = hauteur\n  ) %>%\n  arrange(id)\n\n# Matrice de réponses hauteur (t1..t4) et facteurs\nbase$hauteur    <- as.matrix(base[, c(\"t1\",\"t2\",\"t3\",\"t4\")])\nbase$fertilisant <- factor(base$fertilisant)\nbase$variete     <- factor(base$variete)\n\nattach(base)\n```\n\n### 1. Effet du fertilisant à chaque période\n\n```{r dabire-anova-fert, error=TRUE}\nmod.hauteur.fertilisant <- lm(hauteur ~ fertilisant)\nH_fert <- summary(aov(mod.hauteur.fertilisant))\nH_fert\n\nLM_fert <- summary(mod.hauteur.fertilisant)\nLM_fert\n```\n\nCes analyses univariées montrent que l’effet du **fertilisant** sur la hauteur n’est significatif qu’à la période T3, où le fertilisant Ca donne des plantes plus hautes que le fertilisant de référence, alors qu’aux périodes T1, T2 et T4 les différences entre fertilisants ne sont pas statistiquement détectables.\n\n### 2. Effet de la variété à chaque période\n\n```{r dabire-anova-var, error=TRUE}\nmod.hauteur.variete <- lm(hauteur ~ variete)\nH_var <- summary(aov(mod.hauteur.variete))\nH_var\n\nLM_var <- summary(mod.hauteur.variete)\nLM_var\n```\n\nOn observe un effet très net de la **variété** à T1, où la variété 2 produit des plantes sensiblement plus hautes que la variété 1, alors qu’aux périodes T2, T3 et T4 les hauteurs des deux variétés deviennent statistiquement similaires.\n\n### 3. Effet d’interaction variété × fertilisant à chaque période\n\n```{r dabire-anova-inter, error=TRUE}\nmod.hauteur.interaction <- lm(hauteur ~ variete * fertilisant)\nH_int <- summary(aov(mod.hauteur.interaction))\nH_int\n```\n\nL’interaction **variété × fertilisant** n’est significative à aucune période, ce qui suggère que, à instant donné, l’effet de la variété est globalement parallèle d’un fertilisant à l’autre.\n\n### 4. Modèle global à mesures répétées avec `car::Anova`\n\n```{r dabire-rm, error=TRUE}\nfact.temps <- data.frame(TEMPS = as.factor(1:4))\n\nmod.hauteur.tps.interaction <- Anova(\n  mod.hauteur.interaction,\n  idata   = fact.temps,\n  idesign = ~ TEMPS,\n  type    = \"III\",\n  test    = \"Wilks\"\n)\n\nsummary(mod.hauteur.tps.interaction)\n```\n\nLes tests multivariés confirment un effet global du **temps** et une interaction significative **variété × temps**, indiquant que l’écart entre variétés varie au cours des quatre mesures, tandis que les interactions impliquant le fertilisant avec le temps restent non significatives.\n\n# Conclusion\n\nCette **ANOVA à mesures répétées** (implémentée à la fois avec `afex::aov_car` et avec la structure multivariée de `car::Anova`) permet de tester si les facteurs **terreau** (`groupe` / `fertilisant`), **variété** (`variete`) et **période** (`periode` / `TEMPS`), ainsi que leurs interactions, expliquent la variable dépendante **taille**. Après vérification des hypothèses (normalité des résidus, homogénéité des variances, sphéricité et corrections associées), l’interprétation des effets significatifs et des **comparaisons post-hoc** permet d’identifier les combinaisons terreau × variété et les périodes qui conduisent aux plus fortes hauteurs de plantes.\n","srcMarkdownNoYaml":"\n\n::: callout-important\n## Objectif du chapitre\n\nIdentifier **quels facteurs** (groupe, variété, période) **expliquent** la variable dépendante *taille*, en testant les effets principaux et les interactions (un facteur ; deux facteurs avec ou sans interaction), puis en réalisant les comparaisons post-hoc en cas d'effets significatifs.\n:::\n\n# Objectif\n\nCe chapitre vise à **déterminer les facteurs qui peuvent expliquer la variable dépendante** (la hauteur des plantes). On distingue classiquement :\n\n-   **Un facteur** : on teste l'effet d'un seul facteur (ex. fertilisant, ou variété, ou période) sur la variable dépendante.\n-   **Deux facteurs avec ou sans interaction** : on teste les effets de deux facteurs (ex. fertilisant et variété, ou fertilisant et période) et leur interaction. Si l'interaction est significative, l'effet d'un facteur dépend du niveau de l'autre ; sinon, les effets principaux suffisent à interpréter les résultats.\n\nDans notre étude, la variable dépendante est la **hauteur** ; les facteurs sont le **fertilisant** (terreau : Ma, Ca, An), la **variété** (Var1, Var2) et la **période** (T1–T4). Les plantes sont toutes différentes (individus uniques), avec des mesures répétées dans le temps. On utilise un **modèle linéaire (LM)** à effets fixes : **fertilisant** (principal), **variété** (contrôle) et **période** ; chaque ligne des données correspond à une observation de hauteur.\n\n# Données et modèle linéaire (LM)\n\nLes mêmes données qu’au chapitre 2 sont chargées puis analysées avec un modèle **hauteur \\~ fertilisant × variété + Error(id / période)** : effets fixes *fertilisant* (3 terreaux), *variété* (2 variétés), *période* (T1–T4) et interactions ; effet aléatoire intercept par *plante* (id). Tous les sujets sont inclus.\n\n## Explication de ce qui est fait dans le modèle\n\nVoici, dans l'ordre, ce que fait le chapitre en utilisant **uniquement une ANOVA à mesures répétées avec `afex::aov_car`**.\n\n**1. Import et préparation des données**\n\n-   Lecture du fichier Excel `donnees/donnees.xlsx`.\n-   Variables utilisées : **groupe** (terreau Ma, Ca, An), **variete** (Var1, Var2), **periode** (T1–T4), **taille** (variable à expliquer).\n-   Conversion de `taille` en numérique en gérant les **virgules décimales**.\n-   Mise en facteur de `groupe`, `variete`, `periode` avec les bons niveaux.\n-   Création d’un identifiant **technique** `id` (une étiquette par ligne) pour définir la structure des **mesures répétées** dans le modèle (mais sans entrer comme facteur explicatif).\n\n**2. Modèle ANOVA à mesures répétées (afex::aov_car)**\n\n-   Le modèle est ajusté avec :\n    -   **Variable dépendante (dv)** : `taille`.\n    -   **Facteurs inter-sujets (between)** : `groupe` et `variete` (chaque observation appartient à une seule combinaison groupe × variété).\n    -   **Facteur intra-sujet (within)** : `periode` (mêmes plantes suivies à T1, T2, T3, T4).\n-   Formule utilisée :\\\n    \\[ \\text{taille} \\sim \\text{groupe} \\times \\text{variete} + \\text{Error(id / periode)} \\]\n-   `afex::aov_car` calcule une **ANOVA de type III** avec, pour chaque effet (groupe, variete, groupe×variete, etc.) :\n    -   les **sommes de carrés**,\n    -   le **F** de Fisher,\n    -   la **p-value**,\n    -   la **taille d’effet** ((\\eta\\^2) partiel, `pes`).\n\n**3. Sphéricité et corrections (Mauchly, GG, HF)**\n\n-   `summary()` du modèle fournit :\n    -   le **test de Mauchly** de sphéricité pour les effets impliquant `periode`,\n    -   les **corrections de Greenhouse–Geisser (GG)** et **Huynh–Feldt (HF)** si la sphéricité n’est pas respectée.\n-   L’interprétation des effets de `periode` et des interactions avec `periode` se base sur ces p-values corrigées.\n\n**4. Vérifications des conditions de validité**\n\n-   **Normalité des résidus** : graphiques Q–Q et histogramme des résidus de l’ANOVA à mesures répétées.\n-   **Homogénéité des variances (Levene)** : test de Levene sur la **taille moyenne par combinaison groupe × variété × id**, afin de vérifier l’égalité des variances entre conditions.\n\n**5. Comparaisons post-hoc (emmeans)**\n\n-   **Moyennes marginales (groupe × variété)** : estimation des moyennes de `taille` pour chaque combinaison groupe–variété, avec erreurs standard et intervalles de confiance à 95 %.\n-   **Comparaisons deux à deux (Tukey)** :\n    -   Comparaisons entre toutes les combinaisons **groupe × variété** (effets globaux).\n    -   Comparaisons **par période** : mêmes contrastes, mais séparément pour T1, T2, T3, T4, pour repérer les périodes où les différences sont significatives.\n\n**Résumé** : cette ANOVA à mesures répétées teste si le **terreau** (`groupe`), la **variété** (`variete`) et la **période** (`periode`) – ainsi que leurs interactions – expliquent la **taille**, en respectant la structure de mesures répétées. Les diagnostics (normalité, Levene, sphéricité) justifient l’usage des tests F et des post-hoc de Tukey, qui permettent ensuite de conclure sur les conditions (terreau × variété, par période) donnant les tailles les plus élevées.\n\n```{r ch3-libs, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(emmeans)\nlibrary(car)\nif (!requireNamespace(\"afex\", quietly = TRUE)) install.packages(\"afex\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(afex)\nif (!requireNamespace(\"gtsummary\", quietly = TRUE)) install.packages(\"gtsummary\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(gtsummary)\nlibrary(knitr)\n```\n\n```{r ch3-import, error=TRUE}\n# --- Import : plan = mesures répétées T1–T4 pour Var1 et Var2, dans chaque fertilisant ---\nif (!requireNamespace(\"readxl\", quietly = TRUE)) install.packages(\"readxl\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(readxl)\nd <- read_excel(\"donnees/donnees.xlsx\")\n\nd$hauteur <- as.numeric(gsub(\",\", \".\", as.character(d$hauteur)))\nd <- d %>%\n  mutate(\n    periode     = factor(as.character(periode), levels = c(\"T1\", \"T2\", \"T3\", \"T4\")),\n    fertilisant = factor(fertilisant, levels = c(\"Ma\", \"Ca\", \"An\")),\n    variete     = factor(variete)\n  ) %>%\n  # Création d'identifiants \"sujets\" artificiels par (fertilisant, variete, rang)\n  # pour simuler des mesures répétées comme dans l'exemple DABIRE\n  group_by(fertilisant, variete, periode) %>%\n  arrange(fertilisant, variete, periode, .by_group = TRUE) %>%\n  mutate(rang = row_number()) %>%\n  ungroup() %>%\n  mutate(\n    id = interaction(fertilisant, variete, rang, drop = TRUE),\n    id = factor(id)\n  )\n```\n\n## Description du modèle utilisé\n\nLe modèle utilisé est une **ANOVA à mesures répétées** implémentée avec `afex::aov_car`. Chaque ligne du tableau correspond à **une observation de hauteur pour une combinaison (fertilisant, variété, période)**.\n\n| Élément | Description |\n|----|----|\n| **Variable dépendante** | `hauteur` (hauteur des plantes, quantitative) |\n| **Facteurs inter-sujets** | `fertilisant` (3 terreaux : Ma, Ca, An), `variete` (2 variétés) |\n| **Facteur intra-sujet** | `periode` (T1–T4, mesures répétées) |\n| **Identifiant (id)** | Étiquette technique construite par combinaison `(fertilisant, variete, rang)` pour regrouper artificiellement les mesures répétées dans `Error(id / periode)` |\n| **Formule** | `hauteur ~ fertilisant * variete + Error(id / periode)` |\n| **Options** | Type III ; corrections **Greenhouse–Geisser** / **Huynh–Feldt** pour les termes impliquant `periode` ; **η² partiel (pes)** comme taille d’effet |\n\n```{r aov-car, error=TRUE}\n# --- ANOVA à mesures répétées avec afex::aov_car -------------------------\n\n# On fixe le type de sommes de carrés à III (classique en présence d'interactions)\nafex::afex_options(type = 3)\n\n# Ajustement du modèle :\n# - hauteur : variable dépendante\n# - fertilisant * variete : effets fixes inter-sujets et leur interaction\n# - Error(id / periode) : structure de mesures répétées (effet de periode imbriqué dans id)\n# - na.rm = TRUE : les observations manquantes (périodes non observées pour certains individus)\n#   sont retirées de l'analyse, comme suggéré par le message d'erreur d'afex.\nanova_rm <- afex::aov_car(\n  hauteur ~ fertilisant * variete + Error(id / periode),\n  data  = d,\n  na.rm = TRUE\n)\n\n# Tableau ANOVA \"propre\" (nice) :\n# - fournit F, p-value, et η² partiel (pes) pour chaque effet\ntab_rm <- nice(anova_rm, es = \"pes\")\nknitr::kable(\n  tab_rm,\n  caption = \"ANOVA à mesures répétées (afex::aov_car) : effets de fertilisant, variété, période et interactions, avec η² partiel.\"\n)\n\n# Résumé complet du modèle :\n# - inclut le test de Mauchly (sphéricité)\n# - et les corrections GG / HF si nécessaire\nsummary(anova_rm)\n```\n\nEn résumé, la hauteur dépend significativement du **fertilisant** et de la **variété**, ainsi que de la **période** de mesure, avec une interaction significative entre **variété et période** ; les interactions impliquant le fertilisant ne sont pas significatives.\n\nLes tests de **Mauchly** ne sont pas significatifs, ce qui indique que l’hypothèse de sphéricité est raisonnable ; les corrections de Greenhouse–Geisser et Huynh–Feldt confirment la significativité de l’effet de la **période** et de l’interaction **variété × période**, tandis que les termes avec le fertilisant restent non significatifs.\n\n# Vérification des conditions de validité\n\n## Normalité des résidus\n\n```{r normalite, fig.cap=\"Graphique Q-Q et histogramme des résidus de l’ANOVA à mesures répétées.\", error=TRUE}\n# On extrait les résidus du modèle sous-jacent (lm) contenu dans l'objet afex\nres <- residuals(anova_rm$lm)\n\n# Affichage côte à côte :\n# - Q-Q plot : vérification de l'alignement des résidus sur la droite théorique\n# - Histogramme : forme globale (approximation gaussienne attendue)\npar(mfrow = c(1, 2))\nqqnorm(res, main = \"Q-Q des résidus\"); qqline(res)\nhist(res, breaks = 15, main = \"Distribution des résidus\", xlab = \"Résidus\")\npar(mfrow = c(1, 1))\n\n# Test formel de normalité (Shapiro-Wilk)\nshapiro_res <- shapiro.test(res)\nshapiro_res\n```\n\nLes graphes de résidus indiquent une distribution globalement symétrique et proche d’une droite normale, mais le test de Shapiro–Wilk est significatif (p-value très petite), ce qui met en évidence une déviation statistique de la normalité ; compte tenu de la taille d’échantillon et de l’homogénéité des variances, l’ANOVA reste toutefois utilisable avec prudence.\n\n## Homogénéité des variances (Levene)\n\nLe test de Levene est réalisé sur la **hauteur moyenne par combinaison (id, fertilisant, variete)**, ce qui revient à comparer les variances entre conditions expérimentales (fertilisant × variété), indépendamment de la période.\n\n```{r levene, error=TRUE, warning=FALSE}\n# Agrégation : moyenne de hauteur par id, fertilisant, variété\nd_mean <- d %>%\n  group_by(id, fertilisant, variete) %>%\n  summarise(hauteur_moy = mean(hauteur, na.rm = TRUE), .groups = \"drop\")\n\n# Test de Levene sur les variances de hauteur moyenne entre combinaisons fertilisant × variété\nlev <- car::leveneTest(hauteur_moy ~ fertilisant * variete, data = d_mean)\n\n# Mise en forme d'un tableau lisible\nlev_df <- as.data.frame(lev)\nlev_df <- cbind(Source = rownames(lev_df), lev_df)\nrownames(lev_df) <- NULL\nnames(lev_df) <- c(\"Source\", \"Ddl\", \"F\", \"p-value\")\nlev_df[[\"p-value\"]] <- ifelse(is.na(lev_df[[\"p-value\"]]), \"—\", format.pval(lev_df[[\"p-value\"]], digits = 3))\nlev_df[[\"F\"]] <- ifelse(is.na(lev_df[[\"F\"]]), \"—\", format(round(lev_df[[\"F\"]], 4), nsmall = 4))\nlev_df[is.na(lev_df)] <- \"—\"\n\nknitr::kable(\n  lev_df,\n  align = c(\"l\", \"r\", \"r\", \"r\"),\n  caption = \"Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété).\"\n)\n```\n\nLe test de Levene n’étant pas significatif, on peut considérer que les variances de hauteur sont similaires entre les combinaisons de fertilisant et de variété.\n\n# Comparaisons post-hoc\n\n# Comparaisons post-hoc\n\nLorsque des effets ou interactions sont significatifs, les comparaisons deux à deux (Tukey) permettent d’identifier les combinaisons **groupe × variété** et les **périodes** dont les moyennes diffèrent significativement.\n\n## Moyennes marginales (fertilisant × variété)\n\n```{r emm-marginal, error=TRUE}\n# Moyennes marginales (effet global de fertilisant × variété, toutes périodes confondues)\nemm_gv <- emmeans(anova_rm, ~ fertilisant * variete)\n\n# Extraction sous forme de data.frame et arrondi pour la présentation\nemm_gv_df <- summary(emm_gv) %>% as.data.frame()\nemm_gv_df <- emm_gv_df %>%\n  mutate(\n    emmean   = round(emmean, 2),\n    SE       = round(SE, 3),\n    lower.CL = round(lower.CL, 2),\n    upper.CL = round(upper.CL, 2)\n  )\n\nnames(emm_gv_df) <- c(\"Fertilisant\", \"Variété\", \"Moyenne\", \"ESM\", \"Ddl\", \"IC inf.\", \"IC sup.\")\n\nknitr::kable(\n  emm_gv_df[, c(\"Fertilisant\", \"Variété\", \"Moyenne\", \"ESM\", \"IC inf.\", \"IC sup.\")],\n  align = c(\"l\", \"l\", \"r\", \"r\", \"r\", \"r\"),\n  caption = \"Moyennes marginales (et IC 95 %) pour fertilisant × variété (toutes périodes confondues).\"\n)\n```\n\nCes moyennes montrent que, en moyenne sur toutes les périodes, la variété 2 produit des plantes plus hautes que la variété 1 pour un même fertilisant, avec des valeurs maximales observées pour les combinaisons `Ca–Var2` et `Ma–Var2`.\n\n## Comparaisons deux à deux : fertilisant × variété (Tukey)\n\n```{r posthoc-gv, error=TRUE}\n# Comparaisons toutes paires de combinaisons fertilisant × variété (corrigées de Tukey)\nph_gv <- pairs(emm_gv, adjust = \"tukey\") %>% as.data.frame()\npval <- ph_gv$p.value\n\nph_gv <- ph_gv %>%\n  mutate(\n    estimate = round(estimate, 3),\n    SE       = round(SE, 3),\n    t.ratio  = round(t.ratio, 2),\n    signif   = case_when(\n      pval < 0.001 ~ \"***\",\n      pval < 0.01  ~ \"**\",\n      pval < 0.05  ~ \"*\",\n      TRUE         ~ \"\"\n    ),\n    p.value = format.pval(p.value, digits = 3, eps = 0.001)\n  )\n\nnames(ph_gv) <- c(\"Contraste\", \"Différence\", \"ESM\", \"Ddl\", \"t\", \"p-value\", \"Signif.\")\n\nknitr::kable(\n  ph_gv,\n  align = c(\"l\", \"r\", \"r\", \"r\", \"r\", \"r\", \"c\"),\n  caption = \"Comparaisons post-hoc Tukey : fertilisant × variété (toutes périodes confondues). * p < 0,05 ; ** p < 0,01 ; *** p < 0,001.\"\n)\n```\n\nAprès correction de Tukey, seules les combinaisons `Ca–Var2` vs `Ma–Var1` et `Ca–Var2` vs `An–Var1` présentent des différences significatives de hauteur, ce qui confirme un avantage marqué de `Ca–Var2` par rapport à ces deux couples.\n\n## Comparaisons deux à deux par période (Tukey)\n\n```{r posthoc-periode, error=TRUE}\n# Effets de fertilisant × variété examinés séparément pour chaque période (T1, T2, T3, T4)\nemm_per <- emmeans(anova_rm, ~ fertilisant * variete | periode)\nph_per <- pairs(emm_per, adjust = \"tukey\") %>% as.data.frame()\npval_per <- ph_per$p.value\n\nph_per <- ph_per %>%\n  mutate(\n    estimate = round(estimate, 3),\n    SE       = round(SE, 3),\n    t.ratio  = round(t.ratio, 2),\n    signif   = case_when(\n      pval_per < 0.001 ~ \"***\",\n      pval_per < 0.01  ~ \"**\",\n      pval_per < 0.05  ~ \"*\",\n      TRUE             ~ \"\"\n    ),\n    p.value = format.pval(p.value, digits = 3, eps = 0.001)\n  )\n\nnames(ph_per) <- c(\"Contraste\", \"Différence\", \"ESM\", \"Ddl\", \"t\", \"p-value\", \"Signif.\", \"Période\")\n\nknitr::kable(\n  ph_per[, c(\"Période\", \"Contraste\", \"Différence\", \"ESM\", \"t\", \"p-value\", \"Signif.\")],\n  align = c(\"l\", \"l\", \"r\", \"r\", \"r\", \"r\", \"c\"),\n  caption = \"Comparaisons post-hoc Tukey par période. * p < 0,05 ; ** p < 0,01 ; *** p < 0,001.\"\n)\n```\n\nÀ la période T1, plusieurs contrastes sont significatifs et indiquent un net avantage de la variété 2 pour certains fertilisants, alors qu’aux périodes T2, T3 et T4 aucune comparaison fertilisant × variété n’est significative, ce qui suggère un rapprochement des hauteurs entre combinaisons au fil du temps.\n\n# Modèles ANOVA à mesures répétées (structure type DABIRE)\n\nDans cette section, on implémente **exactement le même type de modèles** que dans le rapport de DABIRE (ANOVA par période, puis ANOVA à mesures répétées avec `car::Anova`), en utilisant directement les variables `fertilisant`, `variete`, `periode` et `hauteur` de la base.\n\n```{r dabire-libs, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(knitr)\nif (!requireNamespace(\"nortest\", quietly = TRUE)) install.packages(\"nortest\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(nortest)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(car)\n```\n\n```{r dabire-import, error=TRUE}\n# Import des mêmes données que précédemment\nd2 <- read_excel(\"donnees/donnees.xlsx\")\n\n# Conversion des virgules décimales en points et mise en forme des facteurs\nd2$hauteur <- as.numeric(gsub(\",\", \".\", as.character(d2$hauteur)))\n\nd2 <- d2 %>%\n  mutate(\n    fertilisant = factor(fertilisant),               # Ma, Ca, An\n    variete     = factor(variete),                   # Var1, Var2\n    periode     = factor(periode, levels = c(\"T1\",\"T2\",\"T3\",\"T4\"))\n  )\n```\n\n## Modélisation : ANOVA par période + modèle à mesures répétées\n\n```{r dabire-wide, error=TRUE}\n# Création d'IDs artificiels par (fertilisant, variete, periode)\nd2_id <- d2 %>%\n  group_by(fertilisant, variete, periode) %>%\n  arrange(No, .by_group = TRUE) %>%\n  mutate(rang = row_number()) %>%\n  ungroup() %>%\n  mutate(id = interaction(fertilisant, variete, rang, drop = TRUE))\n\n# Passage au format large : une ligne = un \"sujet\", colonnes t1..t4\nbase <- d2_id %>%\n  mutate(\n    periode_mesure = dplyr::recode(\n      as.character(periode),\n      \"T1\" = \"t1\",\n      \"T2\" = \"t2\",\n      \"T3\" = \"t3\",\n      \"T4\" = \"t4\"\n    )\n  ) %>%\n  select(id, fertilisant, variete, periode_mesure, hauteur) %>%\n  tidyr::pivot_wider(\n    names_from  = periode_mesure,\n    values_from = hauteur\n  ) %>%\n  arrange(id)\n\n# Matrice de réponses hauteur (t1..t4) et facteurs\nbase$hauteur    <- as.matrix(base[, c(\"t1\",\"t2\",\"t3\",\"t4\")])\nbase$fertilisant <- factor(base$fertilisant)\nbase$variete     <- factor(base$variete)\n\nattach(base)\n```\n\n### 1. Effet du fertilisant à chaque période\n\n```{r dabire-anova-fert, error=TRUE}\nmod.hauteur.fertilisant <- lm(hauteur ~ fertilisant)\nH_fert <- summary(aov(mod.hauteur.fertilisant))\nH_fert\n\nLM_fert <- summary(mod.hauteur.fertilisant)\nLM_fert\n```\n\nCes analyses univariées montrent que l’effet du **fertilisant** sur la hauteur n’est significatif qu’à la période T3, où le fertilisant Ca donne des plantes plus hautes que le fertilisant de référence, alors qu’aux périodes T1, T2 et T4 les différences entre fertilisants ne sont pas statistiquement détectables.\n\n### 2. Effet de la variété à chaque période\n\n```{r dabire-anova-var, error=TRUE}\nmod.hauteur.variete <- lm(hauteur ~ variete)\nH_var <- summary(aov(mod.hauteur.variete))\nH_var\n\nLM_var <- summary(mod.hauteur.variete)\nLM_var\n```\n\nOn observe un effet très net de la **variété** à T1, où la variété 2 produit des plantes sensiblement plus hautes que la variété 1, alors qu’aux périodes T2, T3 et T4 les hauteurs des deux variétés deviennent statistiquement similaires.\n\n### 3. Effet d’interaction variété × fertilisant à chaque période\n\n```{r dabire-anova-inter, error=TRUE}\nmod.hauteur.interaction <- lm(hauteur ~ variete * fertilisant)\nH_int <- summary(aov(mod.hauteur.interaction))\nH_int\n```\n\nL’interaction **variété × fertilisant** n’est significative à aucune période, ce qui suggère que, à instant donné, l’effet de la variété est globalement parallèle d’un fertilisant à l’autre.\n\n### 4. Modèle global à mesures répétées avec `car::Anova`\n\n```{r dabire-rm, error=TRUE}\nfact.temps <- data.frame(TEMPS = as.factor(1:4))\n\nmod.hauteur.tps.interaction <- Anova(\n  mod.hauteur.interaction,\n  idata   = fact.temps,\n  idesign = ~ TEMPS,\n  type    = \"III\",\n  test    = \"Wilks\"\n)\n\nsummary(mod.hauteur.tps.interaction)\n```\n\nLes tests multivariés confirment un effet global du **temps** et une interaction significative **variété × temps**, indiquant que l’écart entre variétés varie au cours des quatre mesures, tandis que les interactions impliquant le fertilisant avec le temps restent non significatives.\n\n# Conclusion\n\nCette **ANOVA à mesures répétées** (implémentée à la fois avec `afex::aov_car` et avec la structure multivariée de `car::Anova`) permet de tester si les facteurs **terreau** (`groupe` / `fertilisant`), **variété** (`variete`) et **période** (`periode` / `TEMPS`), ainsi que leurs interactions, expliquent la variable dépendante **taille**. Après vérification des hypothèses (normalité des résidus, homogénéité des variances, sphéricité et corrections associées), l’interprétation des effets significatifs et des **comparaisons post-hoc** permet d’identifier les combinaisons terreau × variété et les périodes qui conduisent aux plus fortes hauteurs de plantes.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"css":["styles.css"],"reference-location":"margin","output-file":"03-facteurs-explicatifs.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","bibliography":["references.bib"],"theme":{"light":"flatly","dark":"darkly"},"page-layout":"full","sidebar":{"style":"docked","search":true,"collapse-level":2},"page-navigation":true,"bread-crumbs":true,"smooth-scroll":true,"code-block-bg":true,"code-block-border":"#e9ecef","highlight":"tango","mainfont":"Source Sans 3","link-color":"#2980b9","fontsize":"1.02em","linestretch":1.55,"title":"Facteurs explicatifs de la variable dépendante","subtitle":"Modèle linéaire (LM), validité et post-hoc"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}