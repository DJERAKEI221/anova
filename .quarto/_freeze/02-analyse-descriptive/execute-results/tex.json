{
  "hash": "d79af457573f1fea5cb4c20a462aee72",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analyse descriptive des variables d'étude\"\nsubtitle: \"Données, moyennes et graphiques d'évolution\"\n---\n\n\n\n\nCe chapitre présente l'import des données de croissance, les statistiques descriptives (moyennes, écarts-types, effectifs) et plusieurs graphiques pour décrire la **hauteur** selon la période, le fertilisant (terreau) et la variété.\n\n# Import des données et préparation\n\nLe fichier **`donnees/donnees.xlsx`** est lu ; les variables sont *fertilisant*, *variete*, *periode*, *hauteur*. Plan : mesures répétées **T1–T4 pour Var1 et Var2** (et pour chaque fertilisant). Le facteur **periode** a pour modalités T1, T2, T3, T4. L’identifiant sujet (*id*) est créé si absent.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(knitr)\nif (!requireNamespace(\"gtsummary\", quietly = TRUE)) install.packages(\"gtsummary\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(gtsummary)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Import : plan = mesures répétées T1–T4 pour Var1 et Var2 (colonnes : fertilisant, variete, periode, hauteur) ---\nif (!requireNamespace(\"readxl\", quietly = TRUE)) install.packages(\"readxl\", repos = \"https://cloud.r-project.org\", quiet = TRUE)\nlibrary(readxl)\nd <- read_excel(\"donnees/donnees.xlsx\")\n\n# Hauteur en numérique (virgule décimale gérée)\nd$hauteur <- as.numeric(gsub(\",\", \".\", as.character(d$hauteur)))\n\n# Identifiant sujet : un id par plante (même id pour les 4 périodes d'une même plante)\nif (!\"id\" %in% names(d)) {\n  d <- d %>%\n    arrange(fertilisant, variete, periode) %>%\n    group_by(fertilisant, variete, periode) %>%\n    mutate(within_subj = row_number()) %>%\n    ungroup() %>%\n    mutate(id = paste0(as.character(fertilisant), \"_\", as.character(variete), \"_\", within_subj))\n}\n\n# Facteurs\nd <- d %>%\n  mutate(\n    periode     = factor(as.character(periode), levels = c(\"T1\", \"T2\", \"T3\", \"T4\")),\n    fertilisant = factor(fertilisant, levels = c(\"Ma\", \"Ca\", \"An\")),\n    variete     = factor(variete),\n    id          = factor(id)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Aperçu du jeu de données (format long) ---\nd %>%\n  tbl_summary(include = c(fertilisant, variete, periode, hauteur), statistic = list(hauteur ~ \"{mean} ({sd})\"), label = list(hauteur ~ \"Hauteur\")) %>%\n  modify_caption(\"Résumé descriptif des variables (fertilisant, variété, période, hauteur)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Résumé descriptif des variables (fertilisant, variété, période, hauteur)\n\n|**Characteristic** | **N = 253** |\n|:------------------|:-----------:|\n|fertilisant        |             |\n|Ma                 |  102 (40%)  |\n|Ca                 |  73 (29%)   |\n|An                 |  78 (31%)   |\n|variete            |             |\n|Var1               |  129 (51%)  |\n|Var2               |  124 (49%)  |\n|periode            |             |\n|T1                 |  78 (31%)   |\n|T2                 |  57 (23%)   |\n|T3                 |  63 (25%)   |\n|T4                 |  55 (22%)   |\n|Hauteur            |   34 (8)    |\n\n\n:::\n:::\n\n\n\n\n# Structure des données\n\nNombre total d'observations, de sujets (plantes) et répartition par fertilisant et variété.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Effectifs : nombre d'observations et de sujets ---\nn_obs   <- nrow(d)\nn_sujets <- n_distinct(d$id)\n# Répartition par fertilisant et variété (nombre de sujets uniques)\nsujets_uniq <- d %>% distinct(id, fertilisant, variete)\n\nsujets_uniq %>%\n  tbl_cross(row = fertilisant, col = variete, margin = \"row\", percent = \"none\") %>%\n  modify_caption(\"Nombre de sujets (plantes) par fertilisant (terreau) et variété\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Nombre de sujets (plantes) par fertilisant (terreau) et variété\n\n|            | Var1 | Var2 |\n|:-----------|:----:|:----:|\n|fertilisant |      |      |\n|Ma          |  18  |  16  |\n|Ca          |  12  |  11  |\n|An          |  11  |  13  |\n|Total       |  41  |  40  |\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n**Total :**\", n_obs, \"observations,\", n_sujets, \"sujets.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n**Total :** 253 observations, 81 sujets.\n```\n\n\n:::\n:::\n\n\n\n\n# Résumé de la variable hauteur\n\nStatistiques globales (moyenne, écart-type, min, max) et par facteur.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Résumé global de la variable hauteur ---\nhauteur_num <- as.numeric(as.character(d$hauteur))\nresum_global <- tibble(\n  Variable = \"Hauteur\",\n  n = sum(!is.na(hauteur_num)),\n  `Moyenne (ET)` = sprintf(\"%.2f (%.2f)\", mean(hauteur_num, na.rm = TRUE), sd(hauteur_num, na.rm = TRUE)),\n  Min = sprintf(\"%.2f\", min(hauteur_num, na.rm = TRUE)),\n  Max = sprintf(\"%.2f\", max(hauteur_num, na.rm = TRUE))\n)\nknitr::kable(resum_global, caption = \"Résumé global de la variable hauteur\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Résumé global de la variable hauteur\n\n|Variable |   n|Moyenne (ET) |Min  |Max   |\n|:--------|---:|:------------|:----|:-----|\n|Hauteur  | 253|34.27 (8.16) |8.50 |56.20 |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Résumé de la hauteur par fertilisant, par variété et par période ---\nresum_grp <- d %>% group_by(fertilisant) %>% summarise(n = n(), `Moyenne (ET)` = sprintf(\"%.2f (%.2f)\", mean(hauteur, na.rm = TRUE), sd(hauteur, na.rm = TRUE)), .groups = \"drop\")\nresum_var <- d %>% group_by(variete) %>% summarise(n = n(), `Moyenne (ET)` = sprintf(\"%.2f (%.2f)\", mean(hauteur, na.rm = TRUE), sd(hauteur, na.rm = TRUE)), .groups = \"drop\")\nresum_per <- d %>% group_by(periode) %>% summarise(n = n(), `Moyenne (ET)` = sprintf(\"%.2f (%.2f)\", mean(hauteur, na.rm = TRUE), sd(hauteur, na.rm = TRUE)), .groups = \"drop\")\nknitr::kable(resum_grp, caption = \"Hauteur : moyenne (ET) par fertilisant (terreau)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Hauteur : moyenne (ET) par fertilisant (terreau)\n\n|fertilisant |   n|Moyenne (ET) |\n|:-----------|---:|:------------|\n|Ma          | 102|33.76 (7.63) |\n|Ca          |  73|35.76 (7.45) |\n|An          |  78|33.53 (9.31) |\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(resum_var, caption = \"Hauteur : moyenne (ET) par variété\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Hauteur : moyenne (ET) par variété\n\n|variete |   n|Moyenne (ET) |\n|:-------|---:|:------------|\n|Var1    | 129|32.04 (8.31) |\n|Var2    | 124|36.59 (7.35) |\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(resum_per, caption = \"Hauteur : moyenne (ET) par période\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Hauteur : moyenne (ET) par période\n\n|periode |  n|Moyenne (ET) |\n|:-------|--:|:------------|\n|T1      | 78|34.32 (9.19) |\n|T2      | 57|35.41 (6.92) |\n|T3      | 63|31.42 (7.89) |\n|T4      | 55|36.27 (7.38) |\n\n\n:::\n:::\n\n\n\n\n# Tableau des moyennes et écarts-types (fertilisant × variété × période)\n\nLes statistiques descriptives de la **hauteur** sont calculées pour chaque combinaison de *fertilisant*, *variété* et *période*.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- Tableau croisé fertilisant × variété × période : moyenne (ET) ---\nd %>%\n  mutate(fertilisant_variete = paste(as.character(fertilisant), as.character(variete), sep = \" × \")) %>%\n  tbl_strata(\n    strata = fertilisant_variete,\n    .tbl_fun = ~ tbl_summary(.x, by = periode, include = hauteur, statistic = list(hauteur ~ \"{mean} ({sd})\"), label = list(hauteur ~ \"Hauteur\")),\n    .header = \"**{strata}**\",\n    .combine_with = \"tbl_stack\"\n  ) %>%\n  modify_caption(\"Moyennes et écarts-types de la hauteur par fertilisant, variété et période\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Moyennes et écarts-types de la hauteur par fertilisant, variété et période\n\n|**Group**     |**Characteristic** | **T1**, N = 11 | **T2**, N = 10 | **T3**, N = 9 | **T4**, N = 5 |\n|:-------------|:------------------|:--------------:|:--------------:|:-------------:|:-------------:|\n|**An × Var1** |Hauteur            |    29 (10)     |     34 (8)     |    28 (8)     |    35 (14)    |\n|**An × Var2** |Hauteur            |     40 (8)     |     36 (7)     |    32 (10)    |    33 (6)     |\n|**Ca × Var1** |Hauteur            |     32 (7)     |     35 (7)     |    34 (4)     |    34 (12)    |\n|**Ca × Var2** |Hauteur            |   40.6 (9.1)   |   36.0 (5.8)   |  37.2 (6.9)   |  40.3 (3.7)   |\n|**Ma × Var1** |Hauteur            |     28 (6)     |     36 (8)     |    28 (8)     |    36 (6)     |\n|**Ma × Var2** |Hauteur            |   39.4 (6.5)   |   33.1 (6.0)   |  31.1 (5.9)   |  37.7 (4.6)   |\n\n\n:::\n:::\n\n\n\n\n# Graphiques descriptifs\n\n## Distribution de la hauteur par période\n\nBoîtes à moustaches pour comparer la distribution de la hauteur à chaque période.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = periode, y = hauteur, fill = periode)) +\n  geom_boxplot(alpha = 0.7) +\n  scale_fill_brewer(palette = \"Pastel1\") +\n  labs(x = \"Période\", y = \"Hauteur\") +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Distribution de la hauteur (boîtes à moustaches) par période.](02-analyse-descriptive_files/figure-pdf/ch2-boxplot-periode-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Distribution de la taille par groupe (terreau)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = fertilisant, y = hauteur, fill = fertilisant)) +\n  geom_boxplot(alpha = 0.7) +\n  scale_fill_brewer(palette = \"Set1\") +\n  labs(x = \"Fertilisant (terreau)\", y = \"Hauteur\") +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Distribution de la hauteur par fertilisant (terreau).](02-analyse-descriptive_files/figure-pdf/ch2-boxplot-groupe-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Graphique d'interaction (évolution selon la période)\n\nÉvolution des moyennes de **hauteur** en fonction de la **période**, avec des couleurs par **fertilisant** et des facettes par **variété**. Des courbes non parallèles suggèrent une interaction entre période et fertilisant (ou variété).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd %>%\n  group_by(fertilisant, variete, periode) %>%\n  summarise(hauteur_moy = mean(hauteur, na.rm = TRUE), .groups = \"drop\") %>%\n  ggplot(aes(x = periode, y = hauteur_moy, colour = fertilisant, group = fertilisant)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 3) +\n  facet_wrap(~ variete, ncol = 2) +\n  scale_color_brewer(palette = \"Set1\") +\n  labs(\n    x = \"Période\",\n    y = \"Hauteur (moyenne)\",\n    colour = \"Fertilisant (terreau)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"bottom\",\n    strip.background = element_rect(fill = \"grey92\", colour = NA)\n  )\n```\n\n::: {.cell-output-display}\n![Évolution de la hauteur (moyenne) selon la période, par fertilisant et par variété.](02-analyse-descriptive_files/figure-pdf/ch2-plot-interaction-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Synthèse descriptive\n\nLe tableau et les graphiques ci-dessus permettent de repérer visuellement les combinaisons (fertilisant × variété × période) pour lesquelles la hauteur moyenne est la plus élevée ou la plus faible, et d'anticiper d'éventuelles interactions testées au chapitre 3.\n",
    "supporting": [
      "02-analyse-descriptive_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}