<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Facteurs explicatifs de la variable dépendante – TRAVAIL PRATIQUE D'ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-analyse-descriptive.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-facteurs-explicatifs.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Facteurs explicatifs de la variable dépendante</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">TRAVAIL PRATIQUE D’ANOVA</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bienvenue</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-theorie-anova-mesures-repetees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Théorie sur l’Analyse de la Variance à mesures répétées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-analyse-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analyse descriptive des variables d’étude</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-facteurs-explicatifs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Facteurs explicatifs de la variable dépendante</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objectif" id="toc-objectif" class="nav-link active" data-scroll-target="#objectif"><span class="header-section-number">5</span> Objectif</a></li>
  <li><a href="#données-et-modèle-linéaire-lm" id="toc-données-et-modèle-linéaire-lm" class="nav-link" data-scroll-target="#données-et-modèle-linéaire-lm"><span class="header-section-number">6</span> Données et modèle linéaire (LM)</a>
  <ul class="collapse">
  <li><a href="#explication-de-ce-qui-est-fait-dans-le-modèle" id="toc-explication-de-ce-qui-est-fait-dans-le-modèle" class="nav-link" data-scroll-target="#explication-de-ce-qui-est-fait-dans-le-modèle"><span class="header-section-number">6.1</span> Explication de ce qui est fait dans le modèle</a></li>
  <li><a href="#description-du-modèle-utilisé" id="toc-description-du-modèle-utilisé" class="nav-link" data-scroll-target="#description-du-modèle-utilisé"><span class="header-section-number">6.2</span> Description du modèle utilisé</a></li>
  </ul></li>
  <li><a href="#vérification-des-conditions-de-validité" id="toc-vérification-des-conditions-de-validité" class="nav-link" data-scroll-target="#vérification-des-conditions-de-validité"><span class="header-section-number">7</span> Vérification des conditions de validité</a>
  <ul class="collapse">
  <li><a href="#normalité-des-résidus" id="toc-normalité-des-résidus" class="nav-link" data-scroll-target="#normalité-des-résidus"><span class="header-section-number">7.1</span> Normalité des résidus</a></li>
  <li><a href="#homogénéité-des-variances-levene" id="toc-homogénéité-des-variances-levene" class="nav-link" data-scroll-target="#homogénéité-des-variances-levene"><span class="header-section-number">7.2</span> Homogénéité des variances (Levene)</a></li>
  </ul></li>
  <li><a href="#comparaisons-post-hoc" id="toc-comparaisons-post-hoc" class="nav-link" data-scroll-target="#comparaisons-post-hoc"><span class="header-section-number">8</span> Comparaisons post-hoc</a></li>
  <li><a href="#comparaisons-post-hoc-1" id="toc-comparaisons-post-hoc-1" class="nav-link" data-scroll-target="#comparaisons-post-hoc-1"><span class="header-section-number">9</span> Comparaisons post-hoc</a>
  <ul class="collapse">
  <li><a href="#moyennes-marginales-fertilisant-variété" id="toc-moyennes-marginales-fertilisant-variété" class="nav-link" data-scroll-target="#moyennes-marginales-fertilisant-variété"><span class="header-section-number">9.1</span> Moyennes marginales (fertilisant × variété)</a></li>
  <li><a href="#comparaisons-deux-à-deux-fertilisant-variété-tukey" id="toc-comparaisons-deux-à-deux-fertilisant-variété-tukey" class="nav-link" data-scroll-target="#comparaisons-deux-à-deux-fertilisant-variété-tukey"><span class="header-section-number">9.2</span> Comparaisons deux à deux : fertilisant × variété (Tukey)</a></li>
  <li><a href="#comparaisons-deux-à-deux-par-période-tukey" id="toc-comparaisons-deux-à-deux-par-période-tukey" class="nav-link" data-scroll-target="#comparaisons-deux-à-deux-par-période-tukey"><span class="header-section-number">9.3</span> Comparaisons deux à deux par période (Tukey)</a></li>
  </ul></li>
  <li><a href="#modèles-anova-à-mesures-répétées-structure-type-dabire" id="toc-modèles-anova-à-mesures-répétées-structure-type-dabire" class="nav-link" data-scroll-target="#modèles-anova-à-mesures-répétées-structure-type-dabire"><span class="header-section-number">10</span> Modèles ANOVA à mesures répétées (structure type DABIRE)</a>
  <ul class="collapse">
  <li><a href="#modélisation-anova-par-période-modèle-à-mesures-répétées" id="toc-modélisation-anova-par-période-modèle-à-mesures-répétées" class="nav-link" data-scroll-target="#modélisation-anova-par-période-modèle-à-mesures-répétées"><span class="header-section-number">10.1</span> Modélisation : ANOVA par période + modèle à mesures répétées</a>
  <ul class="collapse">
  <li><a href="#effet-du-fertilisant-à-chaque-période" id="toc-effet-du-fertilisant-à-chaque-période" class="nav-link" data-scroll-target="#effet-du-fertilisant-à-chaque-période"><span class="header-section-number">10.1.1</span> 1. Effet du fertilisant à chaque période</a></li>
  <li><a href="#effet-de-la-variété-à-chaque-période" id="toc-effet-de-la-variété-à-chaque-période" class="nav-link" data-scroll-target="#effet-de-la-variété-à-chaque-période"><span class="header-section-number">10.1.2</span> 2. Effet de la variété à chaque période</a></li>
  <li><a href="#effet-dinteraction-variété-fertilisant-à-chaque-période" id="toc-effet-dinteraction-variété-fertilisant-à-chaque-période" class="nav-link" data-scroll-target="#effet-dinteraction-variété-fertilisant-à-chaque-période"><span class="header-section-number">10.1.3</span> 3. Effet d’interaction variété × fertilisant à chaque période</a></li>
  <li><a href="#modèle-global-à-mesures-répétées-avec-caranova" id="toc-modèle-global-à-mesures-répétées-avec-caranova" class="nav-link" data-scroll-target="#modèle-global-à-mesures-répétées-avec-caranova"><span class="header-section-number">10.1.4</span> 4. Modèle global à mesures répétées avec <code>car::Anova</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">11</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Facteurs explicatifs de la variable dépendante</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Modèle linéaire (LM), validité et post-hoc</p>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Objectif du chapitre
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identifier <strong>quels facteurs</strong> (groupe, variété, période) <strong>expliquent</strong> la variable dépendante <em>taille</em>, en testant les effets principaux et les interactions (un facteur ; deux facteurs avec ou sans interaction), puis en réalisant les comparaisons post-hoc en cas d’effets significatifs.</p>
</div>
</div>
<section id="objectif" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Objectif</h1>
<p>Ce chapitre vise à <strong>déterminer les facteurs qui peuvent expliquer la variable dépendante</strong> (la hauteur des plantes). On distingue classiquement :</p>
<ul>
<li><strong>Un facteur</strong> : on teste l’effet d’un seul facteur (ex. fertilisant, ou variété, ou période) sur la variable dépendante.</li>
<li><strong>Deux facteurs avec ou sans interaction</strong> : on teste les effets de deux facteurs (ex. fertilisant et variété, ou fertilisant et période) et leur interaction. Si l’interaction est significative, l’effet d’un facteur dépend du niveau de l’autre ; sinon, les effets principaux suffisent à interpréter les résultats.</li>
</ul>
<p>Dans notre étude, la variable dépendante est la <strong>hauteur</strong> ; les facteurs sont le <strong>fertilisant</strong> (terreau : Ma, Ca, An), la <strong>variété</strong> (Var1, Var2) et la <strong>période</strong> (T1–T4). Les plantes sont toutes différentes (individus uniques), avec des mesures répétées dans le temps. On utilise un <strong>modèle linéaire (LM)</strong> à effets fixes : <strong>fertilisant</strong> (principal), <strong>variété</strong> (contrôle) et <strong>période</strong> ; chaque ligne des données correspond à une observation de hauteur.</p>
</section>
<section id="données-et-modèle-linéaire-lm" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Données et modèle linéaire (LM)</h1>
<p>Les mêmes données qu’au chapitre 2 sont chargées puis analysées avec un modèle <strong>hauteur ~ fertilisant × variété + Error(id / période)</strong> : effets fixes <em>fertilisant</em> (3 terreaux), <em>variété</em> (2 variétés), <em>période</em> (T1–T4) et interactions ; effet aléatoire intercept par <em>plante</em> (id). Tous les sujets sont inclus.</p>
<section id="explication-de-ce-qui-est-fait-dans-le-modèle" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="explication-de-ce-qui-est-fait-dans-le-modèle"><span class="header-section-number">6.1</span> Explication de ce qui est fait dans le modèle</h2>
<p>Voici, dans l’ordre, ce que fait le chapitre en utilisant <strong>uniquement une ANOVA à mesures répétées avec <code>afex::aov_car</code></strong>.</p>
<p><strong>1. Import et préparation des données</strong></p>
<ul>
<li>Lecture du fichier Excel <code>donnees/donnees.xlsx</code>.</li>
<li>Variables utilisées : <strong>groupe</strong> (terreau Ma, Ca, An), <strong>variete</strong> (Var1, Var2), <strong>periode</strong> (T1–T4), <strong>taille</strong> (variable à expliquer).</li>
<li>Conversion de <code>taille</code> en numérique en gérant les <strong>virgules décimales</strong>.</li>
<li>Mise en facteur de <code>groupe</code>, <code>variete</code>, <code>periode</code> avec les bons niveaux.</li>
<li>Création d’un identifiant <strong>technique</strong> <code>id</code> (une étiquette par ligne) pour définir la structure des <strong>mesures répétées</strong> dans le modèle (mais sans entrer comme facteur explicatif).</li>
</ul>
<p><strong>2. Modèle ANOVA à mesures répétées (afex::aov_car)</strong></p>
<ul>
<li>Le modèle est ajusté avec :
<ul>
<li><strong>Variable dépendante (dv)</strong> : <code>taille</code>.</li>
<li><strong>Facteurs inter-sujets (between)</strong> : <code>groupe</code> et <code>variete</code> (chaque observation appartient à une seule combinaison groupe × variété).</li>
<li><strong>Facteur intra-sujet (within)</strong> : <code>periode</code> (mêmes plantes suivies à T1, T2, T3, T4).</li>
</ul></li>
<li>Formule utilisée :<br>
[ + ]</li>
<li><code>afex::aov_car</code> calcule une <strong>ANOVA de type III</strong> avec, pour chaque effet (groupe, variete, groupe×variete, etc.) :
<ul>
<li>les <strong>sommes de carrés</strong>,</li>
<li>le <strong>F</strong> de Fisher,</li>
<li>la <strong>p-value</strong>,</li>
<li>la <strong>taille d’effet</strong> ((^2) partiel, <code>pes</code>).</li>
</ul></li>
</ul>
<p><strong>3. Sphéricité et corrections (Mauchly, GG, HF)</strong></p>
<ul>
<li><code>summary()</code> du modèle fournit :
<ul>
<li>le <strong>test de Mauchly</strong> de sphéricité pour les effets impliquant <code>periode</code>,</li>
<li>les <strong>corrections de Greenhouse–Geisser (GG)</strong> et <strong>Huynh–Feldt (HF)</strong> si la sphéricité n’est pas respectée.</li>
</ul></li>
<li>L’interprétation des effets de <code>periode</code> et des interactions avec <code>periode</code> se base sur ces p-values corrigées.</li>
</ul>
<p><strong>4. Vérifications des conditions de validité</strong></p>
<ul>
<li><strong>Normalité des résidus</strong> : graphiques Q–Q et histogramme des résidus de l’ANOVA à mesures répétées.</li>
<li><strong>Homogénéité des variances (Levene)</strong> : test de Levene sur la <strong>taille moyenne par combinaison groupe × variété × id</strong>, afin de vérifier l’égalité des variances entre conditions.</li>
</ul>
<p><strong>5. Comparaisons post-hoc (emmeans)</strong></p>
<ul>
<li><strong>Moyennes marginales (groupe × variété)</strong> : estimation des moyennes de <code>taille</code> pour chaque combinaison groupe–variété, avec erreurs standard et intervalles de confiance à 95 %.</li>
<li><strong>Comparaisons deux à deux (Tukey)</strong> :
<ul>
<li>Comparaisons entre toutes les combinaisons <strong>groupe × variété</strong> (effets globaux).</li>
<li>Comparaisons <strong>par période</strong> : mêmes contrastes, mais séparément pour T1, T2, T3, T4, pour repérer les périodes où les différences sont significatives.</li>
</ul></li>
</ul>
<p><strong>Résumé</strong> : cette ANOVA à mesures répétées teste si le <strong>terreau</strong> (<code>groupe</code>), la <strong>variété</strong> (<code>variete</code>) et la <strong>période</strong> (<code>periode</code>) – ainsi que leurs interactions – expliquent la <strong>taille</strong>, en respectant la structure de mesures répétées. Les diagnostics (normalité, Levene, sphéricité) justifient l’usage des tests F et des post-hoc de Tukey, qui permettent ensuite de conclure sur les conditions (terreau × variété, par période) donnant les tailles les plus élevées.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"afex"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"afex"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(afex)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"gtsummary"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Import : plan = mesures répétées T1–T4 pour Var1 et Var2, dans chaque fertilisant ---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"readxl"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"readxl"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"donnees/donnees.xlsx"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>hauteur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, <span class="fu">as.character</span>(d<span class="sc">$</span>hauteur)))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode     =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(periode), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"T3"</span>, <span class="st">"T4"</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fertilisant =</span> <span class="fu">factor</span>(fertilisant, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Ma"</span>, <span class="st">"Ca"</span>, <span class="st">"An"</span>)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">variete     =</span> <span class="fu">factor</span>(variete)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'identifiants "sujets" artificiels par (fertilisant, variete, rang)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pour simuler des mesures répétées comme dans l'exemple DABIRE</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fertilisant, variete, periode) <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fertilisant, variete, periode, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rang =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">interaction</span>(fertilisant, variete, rang, <span class="at">drop =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">factor</span>(id)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="description-du-modèle-utilisé" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="description-du-modèle-utilisé"><span class="header-section-number">6.2</span> Description du modèle utilisé</h2>
<p>Le modèle utilisé est une <strong>ANOVA à mesures répétées</strong> implémentée avec <code>afex::aov_car</code>. Chaque ligne du tableau correspond à <strong>une observation de hauteur pour une combinaison (fertilisant, variété, période)</strong>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Élément</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Variable dépendante</strong></td>
<td><code>hauteur</code> (hauteur des plantes, quantitative)</td>
</tr>
<tr class="even">
<td><strong>Facteurs inter-sujets</strong></td>
<td><code>fertilisant</code> (3 terreaux : Ma, Ca, An), <code>variete</code> (2 variétés)</td>
</tr>
<tr class="odd">
<td><strong>Facteur intra-sujet</strong></td>
<td><code>periode</code> (T1–T4, mesures répétées)</td>
</tr>
<tr class="even">
<td><strong>Identifiant (id)</strong></td>
<td>Étiquette technique construite par combinaison <code>(fertilisant, variete, rang)</code> pour regrouper artificiellement les mesures répétées dans <code>Error(id / periode)</code></td>
</tr>
<tr class="odd">
<td><strong>Formule</strong></td>
<td><code>hauteur ~ fertilisant * variete + Error(id / periode)</code></td>
</tr>
<tr class="even">
<td><strong>Options</strong></td>
<td>Type III ; corrections <strong>Greenhouse–Geisser</strong> / <strong>Huynh–Feldt</strong> pour les termes impliquant <code>periode</code> ; <strong>η² partiel (pes)</strong> comme taille d’effet</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- ANOVA à mesures répétées avec afex::aov_car -------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On fixe le type de sommes de carrés à III (classique en présence d'interactions)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>afex<span class="sc">::</span><span class="fu">afex_options</span>(<span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle :</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - hauteur : variable dépendante</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - fertilisant * variete : effets fixes inter-sujets et leur interaction</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Error(id / periode) : structure de mesures répétées (effet de periode imbriqué dans id)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - na.rm = TRUE : les observations manquantes (périodes non observées pour certains individus)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   sont retirées de l'analyse, comme suggéré par le message d'erreur d'afex.</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>anova_rm <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_car</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  hauteur <span class="sc">~</span> fertilisant <span class="sc">*</span> variete <span class="sc">+</span> <span class="fu">Error</span>(id <span class="sc">/</span> periode),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> d,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau ANOVA "propre" (nice) :</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># - fournit F, p-value, et η² partiel (pes) pour chaque effet</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>tab_rm <span class="ot">&lt;-</span> <span class="fu">nice</span>(anova_rm, <span class="at">es =</span> <span class="st">"pes"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  tab_rm,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"ANOVA à mesures répétées (afex::aov_car) : effets de fertilisant, variété, période et interactions, avec η² partiel."</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>ANOVA à mesures répétées (afex::aov_car) : effets de fertilisant, variété, période et interactions, avec η² partiel.</caption>
<colgroup>
<col style="width: 41%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">MSE</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">pes</th>
<th style="text-align: left;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fertilisant</td>
<td style="text-align: left;">2, 35</td>
<td style="text-align: left;">50.78</td>
<td style="text-align: left;">4.53 *</td>
<td style="text-align: left;">.205</td>
<td style="text-align: left;">.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">variete</td>
<td style="text-align: left;">1, 35</td>
<td style="text-align: left;">50.78</td>
<td style="text-align: left;">10.51 **</td>
<td style="text-align: left;">.231</td>
<td style="text-align: left;">.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fertilisant:variete</td>
<td style="text-align: left;">2, 35</td>
<td style="text-align: left;">50.78</td>
<td style="text-align: left;">0.09</td>
<td style="text-align: left;">.005</td>
<td style="text-align: left;">.916</td>
</tr>
<tr class="even">
<td style="text-align: left;">periode</td>
<td style="text-align: left;">2.59, 90.49</td>
<td style="text-align: left;">73.59</td>
<td style="text-align: left;">5.29 **</td>
<td style="text-align: left;">.131</td>
<td style="text-align: left;">.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fertilisant:periode</td>
<td style="text-align: left;">5.17, 90.49</td>
<td style="text-align: left;">73.59</td>
<td style="text-align: left;">0.49</td>
<td style="text-align: left;">.027</td>
<td style="text-align: left;">.792</td>
</tr>
<tr class="even">
<td style="text-align: left;">variete:periode</td>
<td style="text-align: left;">2.59, 90.49</td>
<td style="text-align: left;">73.59</td>
<td style="text-align: left;">4.77 **</td>
<td style="text-align: left;">.120</td>
<td style="text-align: left;">.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fertilisant:variete:periode</td>
<td style="text-align: left;">5.17, 90.49</td>
<td style="text-align: left;">73.59</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">.056</td>
<td style="text-align: left;">.396</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé complet du modèle :</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - inclut le test de Mauchly (sphéricité)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - et les corrections GG / HF si nécessaire</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_rm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

                            Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)
(Intercept)                 168766      1   1777.2     35 3323.6960 &lt; 2.2e-16
fertilisant                    460      2   1777.2     35    4.5250  0.017870
variete                        534      1   1777.2     35   10.5127  0.002605
fertilisant:variete              9      2   1777.2     35    0.0878  0.916122
periode                       1006      3   6659.0    105    5.2876  0.001956
fertilisant:periode            185      6   6659.0    105    0.4853  0.818020
variete:periode                908      3   6659.0    105    4.7733  0.003694
fertilisant:variete:periode    399      6   6659.0    105    1.0478  0.398892
                               
(Intercept)                 ***
fertilisant                 *  
variete                     ** 
fertilisant:variete            
periode                     ** 
fertilisant:periode            
variete:periode             ** 
fertilisant:variete:periode    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

                            Test statistic p-value
periode                            0.80217 0.19052
fertilisant:periode                0.80217 0.19052
variete:periode                    0.80217 0.19052
fertilisant:variete:periode        0.80217 0.19052


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

                             GG eps Pr(&gt;F[GG])   
periode                     0.86184   0.003361 **
fertilisant:periode         0.86184   0.792291   
variete:periode             0.86184   0.005876 **
fertilisant:variete:periode 0.86184   0.395740   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                               HF eps  Pr(&gt;F[HF])
periode                     0.9365994 0.002506562
fertilisant:periode         0.9365994 0.806780783
variete:periode             0.9365994 0.004568788
fertilisant:variete:periode 0.9365994 0.397572844</code></pre>
</div>
</div>
<p>En résumé, la hauteur dépend significativement du <strong>fertilisant</strong> et de la <strong>variété</strong>, ainsi que de la <strong>période</strong> de mesure, avec une interaction significative entre <strong>variété et période</strong> ; les interactions impliquant le fertilisant ne sont pas significatives.</p>
<p>Les tests de <strong>Mauchly</strong> ne sont pas significatifs, ce qui indique que l’hypothèse de sphéricité est raisonnable ; les corrections de Greenhouse–Geisser et Huynh–Feldt confirment la significativité de l’effet de la <strong>période</strong> et de l’interaction <strong>variété × période</strong>, tandis que les termes avec le fertilisant restent non significatifs.</p>
</section>
</section>
<section id="vérification-des-conditions-de-validité" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Vérification des conditions de validité</h1>
<section id="normalité-des-résidus" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="normalité-des-résidus"><span class="header-section-number">7.1</span> Normalité des résidus</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extrait les résidus du modèle sous-jacent (lm) contenu dans l'objet afex</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(anova_rm<span class="sc">$</span>lm)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage côte à côte :</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Q-Q plot : vérification de l'alignement des résidus sur la droite théorique</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Histogramme : forme globale (approximation gaussienne attendue)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res, <span class="at">main =</span> <span class="st">"Q-Q des résidus"</span>); <span class="fu">qqline</span>(res)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">"Distribution des résidus"</span>, <span class="at">xlab =</span> <span class="st">"Résidus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-facteurs-explicatifs_files/figure-html/normalite-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Graphique Q-Q et histogramme des résidus de l’ANOVA à mesures répétées.</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test formel de normalité (Shapiro-Wilk)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>shapiro_res <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(res)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>shapiro_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  res
W = 0.96094, p-value = 0.0001458</code></pre>
</div>
</div>
<p>Les graphes de résidus indiquent une distribution globalement symétrique et proche d’une droite normale, mais le test de Shapiro–Wilk est significatif (p-value très petite), ce qui met en évidence une déviation statistique de la normalité ; compte tenu de la taille d’échantillon et de l’homogénéité des variances, l’ANOVA reste toutefois utilisable avec prudence.</p>
</section>
<section id="homogénéité-des-variances-levene" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="homogénéité-des-variances-levene"><span class="header-section-number">7.2</span> Homogénéité des variances (Levene)</h2>
<p>Le test de Levene est réalisé sur la <strong>hauteur moyenne par combinaison (id, fertilisant, variete)</strong>, ce qui revient à comparer les variances entre conditions expérimentales (fertilisant × variété), indépendamment de la période.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrégation : moyenne de hauteur par id, fertilisant, variété</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>d_mean <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id, fertilisant, variete) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hauteur_moy =</span> <span class="fu">mean</span>(hauteur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Levene sur les variances de hauteur moyenne entre combinaisons fertilisant × variété</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>lev <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">leveneTest</span>(hauteur_moy <span class="sc">~</span> fertilisant <span class="sc">*</span> variete, <span class="at">data =</span> d_mean)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en forme d'un tableau lisible</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>lev_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(lev)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>lev_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Source =</span> <span class="fu">rownames</span>(lev_df), lev_df)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(lev_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lev_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Ddl"</span>, <span class="st">"F"</span>, <span class="st">"p-value"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>lev_df[[<span class="st">"p-value"</span>]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(lev_df[[<span class="st">"p-value"</span>]]), <span class="st">"—"</span>, <span class="fu">format.pval</span>(lev_df[[<span class="st">"p-value"</span>]], <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>lev_df[[<span class="st">"F"</span>]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(lev_df[[<span class="st">"F"</span>]]), <span class="st">"—"</span>, <span class="fu">format</span>(<span class="fu">round</span>(lev_df[[<span class="st">"F"</span>]], <span class="dv">4</span>), <span class="at">nsmall =</span> <span class="dv">4</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>lev_df[<span class="fu">is.na</span>(lev_df)] <span class="ot">&lt;-</span> <span class="st">"—"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  lev_df,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété)."</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété).</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">Ddl</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.8640</td>
<td style="text-align: right;">0.509</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Le test de Levene n’étant pas significatif, on peut considérer que les variances de hauteur sont similaires entre les combinaisons de fertilisant et de variété.</p>
</section>
</section>
<section id="comparaisons-post-hoc" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Comparaisons post-hoc</h1>
</section>
<section id="comparaisons-post-hoc-1" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Comparaisons post-hoc</h1>
<p>Lorsque des effets ou interactions sont significatifs, les comparaisons deux à deux (Tukey) permettent d’identifier les combinaisons <strong>groupe × variété</strong> et les <strong>périodes</strong> dont les moyennes diffèrent significativement.</p>
<section id="moyennes-marginales-fertilisant-variété" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="moyennes-marginales-fertilisant-variété"><span class="header-section-number">9.1</span> Moyennes marginales (fertilisant × variété)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyennes marginales (effet global de fertilisant × variété, toutes périodes confondues)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>emm_gv <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_rm, <span class="sc">~</span> fertilisant <span class="sc">*</span> variete)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction sous forme de data.frame et arrondi pour la présentation</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>emm_gv_df <span class="ot">&lt;-</span> <span class="fu">summary</span>(emm_gv) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>emm_gv_df <span class="ot">&lt;-</span> emm_gv_df <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">emmean   =</span> <span class="fu">round</span>(emmean, <span class="dv">2</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE       =</span> <span class="fu">round</span>(SE, <span class="dv">3</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower.CL =</span> <span class="fu">round</span>(lower.CL, <span class="dv">2</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper.CL =</span> <span class="fu">round</span>(upper.CL, <span class="dv">2</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(emm_gv_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fertilisant"</span>, <span class="st">"Variété"</span>, <span class="st">"Moyenne"</span>, <span class="st">"ESM"</span>, <span class="st">"Ddl"</span>, <span class="st">"IC inf."</span>, <span class="st">"IC sup."</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  emm_gv_df[, <span class="fu">c</span>(<span class="st">"Fertilisant"</span>, <span class="st">"Variété"</span>, <span class="st">"Moyenne"</span>, <span class="st">"ESM"</span>, <span class="st">"IC inf."</span>, <span class="st">"IC sup."</span>)],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Moyennes marginales (et IC 95 %) pour fertilisant × variété (toutes périodes confondues)."</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Moyennes marginales (et IC 95 %) pour fertilisant × variété (toutes périodes confondues).</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Fertilisant</th>
<th style="text-align: left;">Variété</th>
<th style="text-align: right;">Moyenne</th>
<th style="text-align: right;">ESM</th>
<th style="text-align: right;">IC inf.</th>
<th style="text-align: right;">IC sup.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ma</td>
<td style="text-align: left;">Var1</td>
<td style="text-align: right;">31.58</td>
<td style="text-align: right;">1.029</td>
<td style="text-align: right;">29.49</td>
<td style="text-align: right;">33.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ca</td>
<td style="text-align: left;">Var1</td>
<td style="text-align: right;">34.61</td>
<td style="text-align: right;">1.347</td>
<td style="text-align: right;">31.88</td>
<td style="text-align: right;">37.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">An</td>
<td style="text-align: left;">Var1</td>
<td style="text-align: right;">30.04</td>
<td style="text-align: right;">1.593</td>
<td style="text-align: right;">26.81</td>
<td style="text-align: right;">33.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ma</td>
<td style="text-align: left;">Var2</td>
<td style="text-align: right;">36.03</td>
<td style="text-align: right;">1.781</td>
<td style="text-align: right;">32.41</td>
<td style="text-align: right;">39.64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ca</td>
<td style="text-align: left;">Var2</td>
<td style="text-align: right;">37.86</td>
<td style="text-align: right;">1.455</td>
<td style="text-align: right;">34.91</td>
<td style="text-align: right;">40.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">An</td>
<td style="text-align: left;">Var2</td>
<td style="text-align: right;">33.82</td>
<td style="text-align: right;">1.347</td>
<td style="text-align: right;">31.08</td>
<td style="text-align: right;">36.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ces moyennes montrent que, en moyenne sur toutes les périodes, la variété&nbsp;2 produit des plantes plus hautes que la variété&nbsp;1 pour un même fertilisant, avec des valeurs maximales observées pour les combinaisons <code>Ca–Var2</code> et <code>Ma–Var2</code>.</p>
</section>
<section id="comparaisons-deux-à-deux-fertilisant-variété-tukey" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="comparaisons-deux-à-deux-fertilisant-variété-tukey"><span class="header-section-number">9.2</span> Comparaisons deux à deux : fertilisant × variété (Tukey)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaisons toutes paires de combinaisons fertilisant × variété (corrigées de Tukey)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ph_gv <span class="ot">&lt;-</span> <span class="fu">pairs</span>(emm_gv, <span class="at">adjust =</span> <span class="st">"tukey"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> ph_gv<span class="sc">$</span>p.value</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ph_gv <span class="ot">&lt;-</span> ph_gv <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE       =</span> <span class="fu">round</span>(SE, <span class="dv">3</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">t.ratio  =</span> <span class="fu">round</span>(t.ratio, <span class="dv">2</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">signif   =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      pval <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      pval <span class="sc">&lt;</span> <span class="fl">0.01</span>  <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      pval <span class="sc">&lt;</span> <span class="fl">0.05</span>  <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>         <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">eps =</span> <span class="fl">0.001</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ph_gv) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Contraste"</span>, <span class="st">"Différence"</span>, <span class="st">"ESM"</span>, <span class="st">"Ddl"</span>, <span class="st">"t"</span>, <span class="st">"p-value"</span>, <span class="st">"Signif."</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  ph_gv,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Comparaisons post-hoc Tukey : fertilisant × variété (toutes périodes confondues). * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001."</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparaisons post-hoc Tukey : fertilisant × variété (toutes périodes confondues). * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Contraste</th>
<th style="text-align: right;">Différence</th>
<th style="text-align: right;">ESM</th>
<th style="text-align: right;">Ddl</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: center;">Signif.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ma Var1 - Ca Var1</td>
<td style="text-align: right;">-3.029</td>
<td style="text-align: right;">1.694</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.79</td>
<td style="text-align: right;">0.4863</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ma Var1 - An Var1</td>
<td style="text-align: right;">1.541</td>
<td style="text-align: right;">1.896</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.9633</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ma Var1 - Ma Var2</td>
<td style="text-align: right;">-4.444</td>
<td style="text-align: right;">2.057</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-2.16</td>
<td style="text-align: right;">0.2816</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ma Var1 - Ca Var2</td>
<td style="text-align: right;">-6.277</td>
<td style="text-align: right;">1.781</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.52</td>
<td style="text-align: right;">0.0141</td>
<td style="text-align: center;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ma Var1 - An Var2</td>
<td style="text-align: right;">-2.237</td>
<td style="text-align: right;">1.694</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.32</td>
<td style="text-align: right;">0.7722</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ca Var1 - An Var1</td>
<td style="text-align: right;">4.571</td>
<td style="text-align: right;">2.086</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">0.2675</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ca Var1 - Ma Var2</td>
<td style="text-align: right;">-1.414</td>
<td style="text-align: right;">2.233</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">0.9877</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ca Var1 - Ca Var2</td>
<td style="text-align: right;">-3.248</td>
<td style="text-align: right;">1.982</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.64</td>
<td style="text-align: right;">0.5798</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ca Var1 - An Var2</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">1.904</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.9983</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">An Var1 - Ma Var2</td>
<td style="text-align: right;">-5.985</td>
<td style="text-align: right;">2.390</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-2.50</td>
<td style="text-align: right;">0.1505</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">An Var1 - Ca Var2</td>
<td style="text-align: right;">-7.818</td>
<td style="text-align: right;">2.157</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.62</td>
<td style="text-align: right;">0.0109</td>
<td style="text-align: center;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">An Var1 - An Var2</td>
<td style="text-align: right;">-3.778</td>
<td style="text-align: right;">2.086</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.81</td>
<td style="text-align: right;">0.4722</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ma Var2 - Ca Var2</td>
<td style="text-align: right;">-1.833</td>
<td style="text-align: right;">2.300</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.9661</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Ma Var2 - An Var2</td>
<td style="text-align: right;">2.207</td>
<td style="text-align: right;">2.233</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.9186</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ca Var2 - An Var2</td>
<td style="text-align: right;">4.040</td>
<td style="text-align: right;">1.982</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.3422</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Après correction de Tukey, seules les combinaisons <code>Ca–Var2</code> vs <code>Ma–Var1</code> et <code>Ca–Var2</code> vs <code>An–Var1</code> présentent des différences significatives de hauteur, ce qui confirme un avantage marqué de <code>Ca–Var2</code> par rapport à ces deux couples.</p>
</section>
<section id="comparaisons-deux-à-deux-par-période-tukey" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="comparaisons-deux-à-deux-par-période-tukey"><span class="header-section-number">9.3</span> Comparaisons deux à deux par période (Tukey)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets de fertilisant × variété examinés séparément pour chaque période (T1, T2, T3, T4)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>emm_per <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova_rm, <span class="sc">~</span> fertilisant <span class="sc">*</span> variete <span class="sc">|</span> periode)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ph_per <span class="ot">&lt;-</span> <span class="fu">pairs</span>(emm_per, <span class="at">adjust =</span> <span class="st">"tukey"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>pval_per <span class="ot">&lt;-</span> ph_per<span class="sc">$</span>p.value</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ph_per <span class="ot">&lt;-</span> ph_per <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE       =</span> <span class="fu">round</span>(SE, <span class="dv">3</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t.ratio  =</span> <span class="fu">round</span>(t.ratio, <span class="dv">2</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">signif   =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      pval_per <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      pval_per <span class="sc">&lt;</span> <span class="fl">0.01</span>  <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      pval_per <span class="sc">&lt;</span> <span class="fl">0.05</span>  <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>             <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">eps =</span> <span class="fl">0.001</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ph_per) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Contraste"</span>, <span class="st">"Différence"</span>, <span class="st">"ESM"</span>, <span class="st">"Ddl"</span>, <span class="st">"t"</span>, <span class="st">"p-value"</span>, <span class="st">"Signif."</span>, <span class="st">"Période"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  ph_per[, <span class="fu">c</span>(<span class="st">"Période"</span>, <span class="st">"Contraste"</span>, <span class="st">"Différence"</span>, <span class="st">"ESM"</span>, <span class="st">"t"</span>, <span class="st">"p-value"</span>, <span class="st">"Signif."</span>)],</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Comparaisons post-hoc Tukey par période. * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001."</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparaisons post-hoc Tukey par période. * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001.</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 27%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Période</th>
<th style="text-align: left;">Contraste</th>
<th style="text-align: right;">Différence</th>
<th style="text-align: right;">ESM</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: center;">Signif.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var1</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-7.761</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-2.00</td>
<td style="text-align: center;">0.3646</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var1</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">2.705</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: center;">0.9886</td>
</tr>
<tr class="odd">
<td style="text-align: left;">*</td>
<td style="text-align: left;">Ma Var1 - Ma Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-15.525</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.29</td>
<td style="text-align: center;">0.0256</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-12.308</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.01</td>
<td style="text-align: center;">0.0501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">*</td>
<td style="text-align: left;">Ma Var1 - An Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-14.004</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.60</td>
<td style="text-align: center;">0.0115</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var1</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">10.466</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: center;">0.2693</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ma Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-7.764</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.52</td>
<td style="text-align: center;">0.6568</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ca Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-4.548</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: center;">0.9148</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-6.243</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.43</td>
<td style="text-align: center;">0.7095</td>
</tr>
<tr class="even">
<td style="text-align: left;">*</td>
<td style="text-align: left;">An Var1 - Ma Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-18.230</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.33</td>
<td style="text-align: center;">0.0234</td>
</tr>
<tr class="odd">
<td style="text-align: left;">*</td>
<td style="text-align: left;">An Var1 - Ca Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-15.013</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.03</td>
<td style="text-align: center;">0.0477</td>
</tr>
<tr class="even">
<td style="text-align: left;">*</td>
<td style="text-align: left;">An Var1 - An Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-16.709</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-3.49</td>
<td style="text-align: center;">0.0153</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - Ca Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">3.217</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: center;">0.9896</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - An Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">1.521</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: center;">0.9997</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var2 - An Var2</td>
<td style="text-align: right;">T1</td>
<td style="text-align: right;">-1.695</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: center;">0.9990</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var1</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-0.293</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var1</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ma Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">2.550</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: center;">0.9907</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-1.833</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: center;">0.9961</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: center;">0.9998</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var1</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ma Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">2.843</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: center;">0.9895</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ca Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-1.540</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: center;">0.9990</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">1.200</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: center;">0.9996</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ma Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">2.300</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: center;">0.9971</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ca Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-2.083</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: center;">0.9971</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - An Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - Ca Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-4.383</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: center;">0.9399</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - An Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">-1.643</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: center;">0.9992</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var2 - An Var2</td>
<td style="text-align: right;">T2</td>
<td style="text-align: right;">2.740</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: center;">0.9847</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var1</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-6.010</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.75</td>
<td style="text-align: center;">0.5072</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var1</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">1.853</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: center;">0.9965</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ma Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-2.092</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: center;">0.9957</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-6.633</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.84</td>
<td style="text-align: center;">0.4536</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">1.162</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: center;">0.9994</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var1</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">7.863</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: center;">0.4402</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ma Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">3.918</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: center;">0.9517</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ca Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-0.624</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">7.171</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: center;">0.4412</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ma Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-3.945</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.82</td>
<td style="text-align: center;">0.9626</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ca Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-8.487</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: center;">0.3930</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - An Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-0.691</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - Ca Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">-4.542</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: center;">0.9223</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - An Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">3.254</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: center;">0.9781</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var2 - An Var2</td>
<td style="text-align: right;">T3</td>
<td style="text-align: right;">7.795</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: center;">0.3933</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var1</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">1.945</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: center;">0.9959</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var1</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">1.357</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: center;">0.9996</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ma Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-2.708</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: center;">0.9923</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - Ca Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-4.333</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.06</td>
<td style="text-align: center;">0.8950</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var1 - An Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">2.988</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: center;">0.9715</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var1</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-0.589</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: center;">1.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ma Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-4.654</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.90</td>
<td style="text-align: center;">0.9426</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - Ca Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-6.279</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.38</td>
<td style="text-align: center;">0.7409</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var1 - An Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">1.043</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: center;">0.9999</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ma Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-4.065</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: center;">0.9756</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - Ca Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-5.690</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-1.15</td>
<td style="text-align: center;">0.8589</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">An Var1 - An Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">1.631</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: center;">0.9993</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - Ca Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">-1.625</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: center;">0.9996</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ma Var2 - An Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">5.696</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: center;">0.8749</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Ca Var2 - An Var2</td>
<td style="text-align: right;">T4</td>
<td style="text-align: right;">7.321</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: center;">0.6015</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>À la période T1, plusieurs contrastes sont significatifs et indiquent un net avantage de la variété&nbsp;2 pour certains fertilisants, alors qu’aux périodes T2, T3 et T4 aucune comparaison fertilisant × variété n’est significative, ce qui suggère un rapprochement des hauteurs entre combinaisons au fil du temps.</p>
</section>
</section>
<section id="modèles-anova-à-mesures-répétées-structure-type-dabire" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Modèles ANOVA à mesures répétées (structure type DABIRE)</h1>
<p>Dans cette section, on implémente <strong>exactement le même type de modèles</strong> que dans le rapport de DABIRE (ANOVA par période, puis ANOVA à mesures répétées avec <code>car::Anova</code>), en utilisant directement les variables <code>fertilisant</code>, <code>variete</code>, <code>periode</code> et <code>hauteur</code> de la base.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"nortest"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"nortest"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import des mêmes données que précédemment</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"donnees/donnees.xlsx"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion des virgules décimales en points et mise en forme des facteurs</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>hauteur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, <span class="fu">as.character</span>(d2<span class="sc">$</span>hauteur)))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fertilisant =</span> <span class="fu">factor</span>(fertilisant),               <span class="co"># Ma, Ca, An</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">variete     =</span> <span class="fu">factor</span>(variete),                   <span class="co"># Var1, Var2</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode     =</span> <span class="fu">factor</span>(periode, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T1"</span>,<span class="st">"T2"</span>,<span class="st">"T3"</span>,<span class="st">"T4"</span>))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="modélisation-anova-par-période-modèle-à-mesures-répétées" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="modélisation-anova-par-période-modèle-à-mesures-répétées"><span class="header-section-number">10.1</span> Modélisation : ANOVA par période + modèle à mesures répétées</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'IDs artificiels par (fertilisant, variete, periode)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>d2_id <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fertilisant, variete, periode) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(No, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rang =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">interaction</span>(fertilisant, variete, rang, <span class="at">drop =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Passage au format large : une ligne = un "sujet", colonnes t1..t4</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> d2_id <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode_mesure =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.character</span>(periode),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"T1"</span> <span class="ot">=</span> <span class="st">"t1"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"T2"</span> <span class="ot">=</span> <span class="st">"t2"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"T3"</span> <span class="ot">=</span> <span class="st">"t3"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"T4"</span> <span class="ot">=</span> <span class="st">"t4"</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, fertilisant, variete, periode_mesure, hauteur) <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from  =</span> periode_mesure,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> hauteur</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de réponses hauteur (t1..t4) et facteurs</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>base<span class="sc">$</span>hauteur    <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(base[, <span class="fu">c</span>(<span class="st">"t1"</span>,<span class="st">"t2"</span>,<span class="st">"t3"</span>,<span class="st">"t4"</span>)])</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>base<span class="sc">$</span>fertilisant <span class="ot">&lt;-</span> <span class="fu">factor</span>(base<span class="sc">$</span>fertilisant)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>base<span class="sc">$</span>variete     <span class="ot">&lt;-</span> <span class="fu">factor</span>(base<span class="sc">$</span>variete)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="effet-du-fertilisant-à-chaque-période" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="effet-du-fertilisant-à-chaque-période"><span class="header-section-number">10.1.1</span> 1. Effet du fertilisant à chaque période</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod.hauteur.fertilisant <span class="ot">&lt;-</span> <span class="fu">lm</span>(hauteur <span class="sc">~</span> fertilisant)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>H_fert <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">aov</span>(mod.hauteur.fertilisant))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>H_fert</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Response t1 :
            Df Sum Sq Mean Sq F value Pr(&gt;F)
fertilisant  2  258.3  129.15  1.2451 0.2994
Residuals   38 3941.9  103.73               

 Response t2 :
            Df  Sum Sq Mean Sq F value Pr(&gt;F)
fertilisant  2   23.87  11.933   0.232 0.7941
Residuals   38 1954.41  51.432               

 Response t3 :
            Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
fertilisant  2  415.77 207.886  4.3114 0.02054 *
Residuals   38 1832.28  48.218                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response t4 :
            Df  Sum Sq Mean Sq F value Pr(&gt;F)
fertilisant  2   82.58  41.291  0.6244  0.541
Residuals   38 2513.09  66.134               

40 observations effacées parce que manquantes</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>LM_fert <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod.hauteur.fertilisant)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>LM_fert</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Response t1 :

Call:
lm(formula = t1 ~ fertilisant)

Residuals:
     Min       1Q   Median       3Q      Max 
-25.7667  -5.7667  -0.1063   6.2333  19.1154 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     34.267      2.940  11.655  4.1e-14 ***
fertilisantCa    2.818      4.077   0.691    0.494    
fertilisantMa   -3.160      3.889  -0.813    0.422    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.18 on 38 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.0615,    Adjusted R-squared:  0.0121 
F-statistic: 1.245 on 2 and 38 DF,  p-value: 0.2994


Response t2 :

Call:
lm(formula = t2 ~ fertilisant)

Residuals:
    Min      1Q  Median      3Q     Max 
-21.317  -2.654   1.688   4.483   9.988 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.016667   2.070261  16.914   &lt;2e-16 ***
fertilisantCa  1.637179   2.870935   0.570    0.572    
fertilisantMa -0.004167   2.738697  -0.002    0.999    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.172 on 38 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.01206,   Adjusted R-squared:  -0.03993 
F-statistic: 0.232 on 2 and 38 DF,  p-value: 0.7941


Response t3 :

Call:
lm(formula = t3 ~ fertilisant)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.5562  -3.3563   0.9437   4.9167  12.4167 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     26.083      2.005  13.012 1.41e-15 ***
fertilisantCa    7.747      2.780   2.787  0.00826 ** 
fertilisantMa    1.973      2.652   0.744  0.46145    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.944 on 38 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.1849,    Adjusted R-squared:  0.1421 
F-statistic: 4.311 on 2 and 38 DF,  p-value: 0.02054


Response t4 :

Call:
lm(formula = t4 ~ fertilisant)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.369  -2.108   1.631   4.131  12.392 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     33.608      2.348  14.316   &lt;2e-16 ***
fertilisantCa    3.261      3.256   1.002    0.323    
fertilisantMa    2.985      3.106   0.961    0.342    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.132 on 38 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.03182,   Adjusted R-squared:  -0.01914 
F-statistic: 0.6244 on 2 and 38 DF,  p-value: 0.541</code></pre>
</div>
</div>
<p>Ces analyses univariées montrent que l’effet du <strong>fertilisant</strong> sur la hauteur n’est significatif qu’à la période T3, où le fertilisant Ca donne des plantes plus hautes que le fertilisant de référence, alors qu’aux périodes T1, T2 et T4 les différences entre fertilisants ne sont pas statistiquement détectables.</p>
</section>
<section id="effet-de-la-variété-à-chaque-période" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="effet-de-la-variété-à-chaque-période"><span class="header-section-number">10.1.2</span> 2. Effet de la variété à chaque période</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod.hauteur.variete <span class="ot">&lt;-</span> <span class="fu">lm</span>(hauteur <span class="sc">~</span> variete)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>H_var <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">aov</span>(mod.hauteur.variete))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>H_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Response t1 :
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
variete      1 1448.1 1448.12  20.522 5.447e-05 ***
Residuals   39 2752.0   70.57                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response t2 :
            Df  Sum Sq Mean Sq F value Pr(&gt;F)
variete      1    1.29   1.288  0.0254 0.8742
Residuals   39 1976.98  50.692               

 Response t3 :
            Df  Sum Sq Mean Sq F value Pr(&gt;F)
variete      1    9.72   9.718  0.1693  0.683
Residuals   39 2238.34  57.393               

 Response t4 :
            Df  Sum Sq Mean Sq F value Pr(&gt;F)
variete      1   31.75  31.752   0.483 0.4912
Residuals   39 2563.92  65.741               

40 observations effacées parce que manquantes</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>LM_var <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod.hauteur.variete)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>LM_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Response t1 :

Call:
lm(formula = t1 ~ variete)

Residuals:
    Min      1Q  Median      3Q     Max 
-20.425  -5.488   2.012   5.012  15.212 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   28.925      1.715   16.87  &lt; 2e-16 ***
varieteVar2   12.063      2.663    4.53 5.45e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.4 on 39 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.3448,    Adjusted R-squared:  0.328 
F-statistic: 20.52 on 1 and 39 DF,  p-value: 5.447e-05


Response t2 :

Call:
lm(formula = t2 ~ variete)

Residuals:
    Min      1Q  Median      3Q     Max 
-21.623  -2.324   1.677   4.317   9.877 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  35.6833     1.4533  24.553   &lt;2e-16 ***
varieteVar2  -0.3598     2.2570  -0.159    0.874    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.12 on 39 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.0006512, Adjusted R-squared:  -0.02497 
F-statistic: 0.02541 on 1 and 39 DF,  p-value: 0.8742


Response t3 :

Call:
lm(formula = t3 ~ variete)

Residuals:
   Min     1Q Median     3Q    Max 
-17.40  -3.40   1.60   4.50  12.11 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  28.9000     1.5464  18.688   &lt;2e-16 ***
varieteVar2   0.9882     2.4016   0.411    0.683    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.576 on 39 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.004323,  Adjusted R-squared:  -0.02121 
F-statistic: 0.1693 on 1 and 39 DF,  p-value: 0.683


Response t4 :

Call:
lm(formula = t4 ~ variete)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.567  -2.567   1.933   5.147  11.233 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.067      1.655  21.188   &lt;2e-16 ***
varieteVar2    1.786      2.570   0.695    0.491    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.108 on 39 degrees of freedom
  (40 observations effacées parce que manquantes)
Multiple R-squared:  0.01223,   Adjusted R-squared:  -0.01309 
F-statistic: 0.483 on 1 and 39 DF,  p-value: 0.4912</code></pre>
</div>
</div>
<p>On observe un effet très net de la <strong>variété</strong> à T1, où la variété&nbsp;2 produit des plantes sensiblement plus hautes que la variété&nbsp;1, alors qu’aux périodes T2, T3 et T4 les hauteurs des deux variétés deviennent statistiquement similaires.</p>
</section>
<section id="effet-dinteraction-variété-fertilisant-à-chaque-période" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="effet-dinteraction-variété-fertilisant-à-chaque-période"><span class="header-section-number">10.1.3</span> 3. Effet d’interaction variété × fertilisant à chaque période</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod.hauteur.interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(hauteur <span class="sc">~</span> variete <span class="sc">*</span> fertilisant)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>H_int <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">aov</span>(mod.hauteur.interaction))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>H_int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Response t1 :
                    Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
variete              1 1448.12 1448.12 21.6812 4.51e-05 ***
fertilisant          2  132.98   66.49  0.9955   0.3798    
variete:fertilisant  2  281.37  140.68  2.1063   0.1368    
Residuals           35 2337.70   66.79                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response t2 :
                    Df  Sum Sq Mean Sq F value Pr(&gt;F)
variete              1    1.29   1.288  0.0234 0.8793
fertilisant          2   24.88  12.440  0.2261 0.7988
variete:fertilisant  2   26.13  13.065  0.2374 0.7899
Residuals           35 1925.97  55.028               

 Response t3 :
                    Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
variete              1    9.72   9.718  0.1873 0.66787  
fertilisant          2  417.67 208.834  4.0238 0.02674 *
variete:fertilisant  2    4.16   2.082  0.0401 0.96073  
Residuals           35 1816.51  51.900                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response t4 :
                    Df  Sum Sq Mean Sq F value Pr(&gt;F)
variete              1   31.75  31.752  0.4717 0.4967
fertilisant          2  111.98  55.991  0.8318 0.4437
variete:fertilisant  2   95.97  47.987  0.7129 0.4972
Residuals           35 2355.96  67.313               

40 observations effacées parce que manquantes</code></pre>
</div>
</div>
<p>L’interaction <strong>variété × fertilisant</strong> n’est significative à aucune période, ce qui suggère que, à instant donné, l’effet de la variété est globalement parallèle d’un fertilisant à l’autre.</p>
</section>
<section id="modèle-global-à-mesures-répétées-avec-caranova" class="level3" data-number="10.1.4">
<h3 data-number="10.1.4" class="anchored" data-anchor-id="modèle-global-à-mesures-répétées-avec-caranova"><span class="header-section-number">10.1.4</span> 4. Modèle global à mesures répétées avec <code>car::Anova</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fact.temps <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">TEMPS =</span> <span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mod.hauteur.tps.interaction <span class="ot">&lt;-</span> <span class="fu">Anova</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  mod.hauteur.interaction,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">idata   =</span> fact.temps,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">idesign =</span> <span class="sc">~</span> TEMPS,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">type    =</span> <span class="st">"III"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">test    =</span> <span class="st">"Wilks"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.hauteur.tps.interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Type III Repeated Measures MANOVA Tests:

------------------------------------------
 
Term: (Intercept) 

 Response transformation matrix:
   (Intercept)
t1           1
t2           1
t3           1
t4           1

Sum of squares and products for the hypothesis:
            (Intercept)
(Intercept)    72192.13

Multivariate Tests: (Intercept)
                 Df test stat approx F num Df den Df     Pr(&gt;F)    
Pillai            1  0.910358 355.4402      1     35 &lt; 2.22e-16 ***
Wilks             1  0.089642 355.4402      1     35 &lt; 2.22e-16 ***
Hotelling-Lawley  1 10.155434 355.4402      1     35 &lt; 2.22e-16 ***
Roy               1 10.155434 355.4402      1     35 &lt; 2.22e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------
 
Term: variete 

 Response transformation matrix:
   (Intercept)
t1           1
t2           1
t3           1
t4           1

Sum of squares and products for the hypothesis:
            (Intercept)
(Intercept)    666.0362

Multivariate Tests: variete
                 Df test stat approx F num Df den Df   Pr(&gt;F)  
Pillai            1 0.0856665  3.27925      1     35 0.078752 .
Wilks             1 0.9143335  3.27925      1     35 0.078752 .
Hotelling-Lawley  1 0.0936929  3.27925      1     35 0.078752 .
Roy               1 0.0936929  3.27925      1     35 0.078752 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------
 
Term: fertilisant 

 Response transformation matrix:
   (Intercept)
t1           1
t2           1
t3           1
t4           1

Sum of squares and products for the hypothesis:
            (Intercept)
(Intercept)    1096.433

Multivariate Tests: fertilisant
                 Df test stat approx F num Df den Df   Pr(&gt;F)  
Pillai            2 0.1336274 2.699162      2     35 0.081252 .
Wilks             2 0.8663726 2.699162      2     35 0.081252 .
Hotelling-Lawley  2 0.1542378 2.699162      2     35 0.081252 .
Roy               2 0.1542378 2.699162      2     35 0.081252 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------
 
Term: variete:fertilisant 

 Response transformation matrix:
   (Intercept)
t1           1
t2           1
t3           1
t4           1

Sum of squares and products for the hypothesis:
            (Intercept)
(Intercept)    35.67558

Multivariate Tests: variete:fertilisant
                 Df test stat   approx F num Df den Df  Pr(&gt;F)
Pillai            2 0.0049935 0.08782492      2     35 0.91612
Wilks             2 0.9950065 0.08782492      2     35 0.91612
Hotelling-Lawley  2 0.0050186 0.08782492      2     35 0.91612
Roy               2 0.0050186 0.08782492      2     35 0.91612

------------------------------------------
 
Term: TEMPS 

 Response transformation matrix:
   TEMPS1 TEMPS2 TEMPS3
t1      1      0      0
t2      0      1      0
t3      0      0      1
t4     -1     -1     -1

Sum of squares and products for the hypothesis:
        TEMPS1  TEMPS2  TEMPS3
TEMPS1 504.008 -42.168 445.776
TEMPS2 -42.168   3.528 -37.296
TEMPS3 445.776 -37.296 394.272

Multivariate Tests: TEMPS
                 Df test stat approx F num Df den Df   Pr(&gt;F)  
Pillai            1 0.2300553  3.28674      3     33 0.032752 *
Wilks             1 0.7699447  3.28674      3     33 0.032752 *
Hotelling-Lawley  1 0.2987946  3.28674      3     33 0.032752 *
Roy               1 0.2987946  3.28674      3     33 0.032752 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------
 
Term: variete:TEMPS 

 Response transformation matrix:
   TEMPS1 TEMPS2 TEMPS3
t1      1      0      0
t2      0      1      0
t3      0      0      1
t4     -1     -1     -1

Sum of squares and products for the hypothesis:
          TEMPS1    TEMPS2     TEMPS3
TEMPS1 981.03717 52.116167 124.253500
TEMPS2  52.11617  2.768595   6.600786
TEMPS3 124.25350  6.600786  15.737357

Multivariate Tests: variete:TEMPS
                 Df test stat approx F num Df den Df   Pr(&gt;F)  
Pillai            1 0.2275214 3.239876      3     33 0.034423 *
Wilks             1 0.7724786 3.239876      3     33 0.034423 *
Hotelling-Lawley  1 0.2945342 3.239876      3     33 0.034423 *
Roy               1 0.2945342 3.239876      3     33 0.034423 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------
 
Term: fertilisant:TEMPS 

 Response transformation matrix:
   TEMPS1 TEMPS2 TEMPS3
t1      1      0      0
t2      0      1      0
t3      0      0      1
t4     -1     -1     -1

Sum of squares and products for the hypothesis:
          TEMPS1   TEMPS2    TEMPS3
TEMPS1 512.46860 90.53914 408.14814
TEMPS2  90.53914 22.46038  74.88305
TEMPS3 408.14814 74.88305 326.25438

Multivariate Tests: fertilisant:TEMPS
                 Df test stat approx F num Df den Df  Pr(&gt;F)
Pillai            2 0.1644683 1.015495      6     68 0.42274
Wilks             2 0.8358609 1.031664      6     66 0.41287
Hotelling-Lawley  2 0.1959775 1.045213      6     64 0.40482
Roy               2 0.1939470 2.198066      3     34 0.10623

------------------------------------------
 
Term: variete:fertilisant:TEMPS 

 Response transformation matrix:
   TEMPS1 TEMPS2 TEMPS3
t1      1      0      0
t2      0      1      0
t3      0      0      1
t4     -1     -1     -1

Sum of squares and products for the hypothesis:
         TEMPS1    TEMPS2   TEMPS3
TEMPS1 668.4031 143.01790 258.1318
TEMPS2 143.0179  71.05914  61.6922
TEMPS3 258.1318  61.69220 100.7198

Multivariate Tests: variete:fertilisant:TEMPS
                 Df test stat  approx F num Df den Df  Pr(&gt;F)
Pillai            2 0.1508520 0.9245641      6     68 0.48303
Wilks             2 0.8505399 0.9273876      6     66 0.48129
Hotelling-Lawley  2 0.1740872 0.9284653      6     64 0.48078
Roy               2 0.1641155 1.8599762      3     34 0.15499

Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

                           Sum Sq num Df Error SS den Df  F value  Pr(&gt;F)    
(Intercept)               18048.0      1   1777.2     35 355.4402 &lt; 2e-16 ***
variete                     166.5      1   1777.2     35   3.2792 0.07875 .  
fertilisant                 274.1      2   1777.2     35   2.6992 0.08125 .  
variete:fertilisant           8.9      2   1777.2     35   0.0878 0.91612    
TEMPS                       493.2      3   6659.0    105   2.5923 0.05660 .  
variete:TEMPS               658.2      3   6659.0    105   3.4594 0.01905 *  
fertilisant:TEMPS           359.1      6   6659.0    105   0.9437 0.46720    
variete:fertilisant:TEMPS   398.7      6   6659.0    105   1.0478 0.39889    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

                          Test statistic p-value
TEMPS                            0.80217 0.19052
variete:TEMPS                    0.80217 0.19052
fertilisant:TEMPS                0.80217 0.19052
variete:fertilisant:TEMPS        0.80217 0.19052


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

                           GG eps Pr(&gt;F[GG])  
TEMPS                     0.86184    0.06600 .
variete:TEMPS             0.86184    0.02503 *
fertilisant:TEMPS         0.86184    0.45889  
variete:fertilisant:TEMPS 0.86184    0.39574  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                             HF eps Pr(&gt;F[HF])
TEMPS                     0.9365994 0.06072900
variete:TEMPS             0.9365994 0.02159004
fertilisant:TEMPS         0.9365994 0.46356203
variete:fertilisant:TEMPS 0.9365994 0.39757284</code></pre>
</div>
</div>
<p>Les tests multivariés confirment un effet global du <strong>temps</strong> et une interaction significative <strong>variété × temps</strong>, indiquant que l’écart entre variétés varie au cours des quatre mesures, tandis que les interactions impliquant le fertilisant avec le temps restent non significatives.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Conclusion</h1>
<p>Cette <strong>ANOVA à mesures répétées</strong> (implémentée à la fois avec <code>afex::aov_car</code> et avec la structure multivariée de <code>car::Anova</code>) permet de tester si les facteurs <strong>terreau</strong> (<code>groupe</code> / <code>fertilisant</code>), <strong>variété</strong> (<code>variete</code>) et <strong>période</strong> (<code>periode</code> / <code>TEMPS</code>), ainsi que leurs interactions, expliquent la variable dépendante <strong>taille</strong>. Après vérification des hypothèses (normalité des résidus, homogénéité des variances, sphéricité et corrections associées), l’interprétation des effets significatifs et des <strong>comparaisons post-hoc</strong> permet d’identifier les combinaisons terreau × variété et les périodes qui conduisent aux plus fortes hauteurs de plantes.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./02-analyse-descriptive.html" class="pagination-link" aria-label="Analyse descriptive des variables d'étude">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analyse descriptive des variables d’étude</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Facteurs explicatifs de la variable dépendante"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Modèle linéaire (LM), validité et post-hoc"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectif du chapitre</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>Identifier **quels facteurs** (groupe, variété, période) **expliquent** la variable dépendante *taille*, en testant les effets principaux et les interactions (un facteur ; deux facteurs avec ou sans interaction), puis en réalisant les comparaisons post-hoc en cas d'effets significatifs.</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># Objectif</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>Ce chapitre vise à **déterminer les facteurs qui peuvent expliquer la variable dépendante** (la hauteur des plantes). On distingue classiquement :</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Un facteur** : on teste l'effet d'un seul facteur (ex. fertilisant, ou variété, ou période) sur la variable dépendante.</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Deux facteurs avec ou sans interaction** : on teste les effets de deux facteurs (ex. fertilisant et variété, ou fertilisant et période) et leur interaction. Si l'interaction est significative, l'effet d'un facteur dépend du niveau de l'autre ; sinon, les effets principaux suffisent à interpréter les résultats.</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>Dans notre étude, la variable dépendante est la **hauteur** ; les facteurs sont le **fertilisant** (terreau : Ma, Ca, An), la **variété** (Var1, Var2) et la **période** (T1–T4). Les plantes sont toutes différentes (individus uniques), avec des mesures répétées dans le temps. On utilise un **modèle linéaire (LM)** à effets fixes : **fertilisant** (principal), **variété** (contrôle) et **période** ; chaque ligne des données correspond à une observation de hauteur.</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données et modèle linéaire (LM)</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>Les mêmes données qu’au chapitre 2 sont chargées puis analysées avec un modèle **hauteur \~ fertilisant × variété + Error(id / période)** : effets fixes *fertilisant* (3 terreaux), *variété* (2 variétés), *période* (T1–T4) et interactions ; effet aléatoire intercept par *plante* (id). Tous les sujets sont inclus.</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## Explication de ce qui est fait dans le modèle</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>Voici, dans l'ordre, ce que fait le chapitre en utilisant **uniquement une ANOVA à mesures répétées avec `afex::aov_car`**.</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>**1. Import et préparation des données**</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lecture du fichier Excel <span class="in">`donnees/donnees.xlsx`</span>.</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variables utilisées : **groupe** (terreau Ma, Ca, An), **variete** (Var1, Var2), **periode** (T1–T4), **taille** (variable à expliquer).</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Conversion de <span class="in">`taille`</span> en numérique en gérant les **virgules décimales**.</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mise en facteur de <span class="in">`groupe`</span>, <span class="in">`variete`</span>, <span class="in">`periode`</span> avec les bons niveaux.</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Création d’un identifiant **technique** `id` (une étiquette par ligne) pour définir la structure des **mesures répétées** dans le modèle (mais sans entrer comme facteur explicatif).</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>**2. Modèle ANOVA à mesures répétées (afex::aov_car)**</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le modèle est ajusté avec :</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Variable dépendante (dv)** : <span class="in">`taille`</span>.</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Facteurs inter-sujets (between)** : <span class="in">`groupe`</span> et <span class="in">`variete`</span> (chaque observation appartient à une seule combinaison groupe × variété).</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Facteur intra-sujet (within)** : <span class="in">`periode`</span> (mêmes plantes suivies à T1, T2, T3, T4).</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Formule utilisée :\</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="sc">\[</span> \text{taille} \sim \text{groupe} \times \text{variete} + \text{Error(id / periode)} <span class="sc">\]</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`afex::aov_car`</span> calcule une **ANOVA de type III** avec, pour chaque effet (groupe, variete, groupe×variete, etc.) :</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>les **sommes de carrés**,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>le **F** de Fisher,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>la **p-value**,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>la **taille d’effet** ((\eta\^2) partiel, <span class="in">`pes`</span>).</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>**3. Sphéricité et corrections (Mauchly, GG, HF)**</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summary()`</span> du modèle fournit :</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>le **test de Mauchly** de sphéricité pour les effets impliquant <span class="in">`periode`</span>,</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>les **corrections de Greenhouse–Geisser (GG)** et **Huynh–Feldt (HF)** si la sphéricité n’est pas respectée.</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>L’interprétation des effets de <span class="in">`periode`</span> et des interactions avec <span class="in">`periode`</span> se base sur ces p-values corrigées.</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>**4. Vérifications des conditions de validité**</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normalité des résidus** : graphiques Q–Q et histogramme des résidus de l’ANOVA à mesures répétées.</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homogénéité des variances (Levene)** : test de Levene sur la **taille moyenne par combinaison groupe × variété × id**, afin de vérifier l’égalité des variances entre conditions.</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>**5. Comparaisons post-hoc (emmeans)**</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Moyennes marginales (groupe × variété)** : estimation des moyennes de <span class="in">`taille`</span> pour chaque combinaison groupe–variété, avec erreurs standard et intervalles de confiance à 95 %.</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Comparaisons deux à deux (Tukey)** :</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Comparaisons entre toutes les combinaisons **groupe × variété** (effets globaux).</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Comparaisons **par période** : mêmes contrastes, mais séparément pour T1, T2, T3, T4, pour repérer les périodes où les différences sont significatives.</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>**Résumé** : cette ANOVA à mesures répétées teste si le **terreau** (`groupe`), la **variété** (`variete`) et la **période** (`periode`) – ainsi que leurs interactions – expliquent la **taille**, en respectant la structure de mesures répétées. Les diagnostics (normalité, Levene, sphéricité) justifient l’usage des tests F et des post-hoc de Tukey, qui permettent ensuite de conclure sur les conditions (terreau × variété, par période) donnant les tailles les plus élevées.</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ch3-libs, message=FALSE, warning=FALSE}</span></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="in">library(emmeans)</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a><span class="in">if (!requireNamespace("afex", quietly = TRUE)) install.packages("afex", repos = "https://cloud.r-project.org", quiet = TRUE)</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="in">library(afex)</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="in">if (!requireNamespace("gtsummary", quietly = TRUE)) install.packages("gtsummary", repos = "https://cloud.r-project.org", quiet = TRUE)</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="in">library(gtsummary)</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ch3-import, error=TRUE}</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a><span class="in"># --- Import : plan = mesures répétées T1–T4 pour Var1 et Var2, dans chaque fertilisant ---</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a><span class="in">if (!requireNamespace("readxl", quietly = TRUE)) install.packages("readxl", repos = "https://cloud.r-project.org", quiet = TRUE)</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- read_excel("donnees/donnees.xlsx")</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a><span class="in">d$hauteur &lt;- as.numeric(gsub(",", ".", as.character(d$hauteur)))</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- d %&gt;%</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="in">    periode     = factor(as.character(periode), levels = c("T1", "T2", "T3", "T4")),</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a><span class="in">    fertilisant = factor(fertilisant, levels = c("Ma", "Ca", "An")),</span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a><span class="in">    variete     = factor(variete)</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="in">  # Création d'identifiants "sujets" artificiels par (fertilisant, variete, rang)</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="in">  # pour simuler des mesures répétées comme dans l'exemple DABIRE</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(fertilisant, variete, periode) %&gt;%</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(fertilisant, variete, periode, .by_group = TRUE) %&gt;%</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(rang = row_number()) %&gt;%</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a><span class="in">    id = interaction(fertilisant, variete, rang, drop = TRUE),</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a><span class="in">    id = factor(id)</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Description du modèle utilisé</span></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>Le modèle utilisé est une **ANOVA à mesures répétées** implémentée avec `afex::aov_car`. Chaque ligne du tableau correspond à **une observation de hauteur pour une combinaison (fertilisant, variété, période)**.</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>| Élément | Description |</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>|----|----|</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>| **Variable dépendante** | <span class="in">`hauteur`</span> (hauteur des plantes, quantitative) |</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>| **Facteurs inter-sujets** | <span class="in">`fertilisant`</span> (3 terreaux : Ma, Ca, An), <span class="in">`variete`</span> (2 variétés) |</span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>| **Facteur intra-sujet** | <span class="in">`periode`</span> (T1–T4, mesures répétées) |</span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>| **Identifiant (id)** | Étiquette technique construite par combinaison <span class="in">`(fertilisant, variete, rang)`</span> pour regrouper artificiellement les mesures répétées dans <span class="in">`Error(id / periode)`</span> |</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>| **Formule** | <span class="in">`hauteur ~ fertilisant * variete + Error(id / periode)`</span> |</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>| **Options** | Type III ; corrections **Greenhouse–Geisser** / **Huynh–Feldt** pour les termes impliquant `periode` ; **η² partiel (pes)** comme taille d’effet |</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r aov-car, error=TRUE}</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a><span class="in"># --- ANOVA à mesures répétées avec afex::aov_car -------------------------</span></span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a><span class="in"># On fixe le type de sommes de carrés à III (classique en présence d'interactions)</span></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a><span class="in">afex::afex_options(type = 3)</span></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a><span class="in"># Ajustement du modèle :</span></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a><span class="in"># - hauteur : variable dépendante</span></span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a><span class="in"># - fertilisant * variete : effets fixes inter-sujets et leur interaction</span></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a><span class="in"># - Error(id / periode) : structure de mesures répétées (effet de periode imbriqué dans id)</span></span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a><span class="in"># - na.rm = TRUE : les observations manquantes (périodes non observées pour certains individus)</span></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a><span class="in">#   sont retirées de l'analyse, comme suggéré par le message d'erreur d'afex.</span></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a><span class="in">anova_rm &lt;- afex::aov_car(</span></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a><span class="in">  hauteur ~ fertilisant * variete + Error(id / periode),</span></span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a><span class="in">  data  = d,</span></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a><span class="in">  na.rm = TRUE</span></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a><span class="in"># Tableau ANOVA "propre" (nice) :</span></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a><span class="in"># - fournit F, p-value, et η² partiel (pes) pour chaque effet</span></span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a><span class="in">tab_rm &lt;- nice(anova_rm, es = "pes")</span></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(</span></span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_rm,</span></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "ANOVA à mesures répétées (afex::aov_car) : effets de fertilisant, variété, période et interactions, avec η² partiel."</span></span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a><span class="in"># Résumé complet du modèle :</span></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a><span class="in"># - inclut le test de Mauchly (sphéricité)</span></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a><span class="in"># - et les corrections GG / HF si nécessaire</span></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a><span class="in">summary(anova_rm)</span></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>En résumé, la hauteur dépend significativement du **fertilisant** et de la **variété**, ainsi que de la **période** de mesure, avec une interaction significative entre **variété et période** ; les interactions impliquant le fertilisant ne sont pas significatives.</span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>Les tests de **Mauchly** ne sont pas significatifs, ce qui indique que l’hypothèse de sphéricité est raisonnable ; les corrections de Greenhouse–Geisser et Huynh–Feldt confirment la significativité de l’effet de la **période** et de l’interaction **variété × période**, tandis que les termes avec le fertilisant restent non significatifs.</span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a><span class="fu"># Vérification des conditions de validité</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normalité des résidus</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r normalite, fig.cap="Graphique Q-Q et histogramme des résidus de l’ANOVA à mesures répétées.", error=TRUE}</span></span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a><span class="in"># On extrait les résidus du modèle sous-jacent (lm) contenu dans l'objet afex</span></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a><span class="in">res &lt;- residuals(anova_rm$lm)</span></span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a><span class="in"># Affichage côte à côte :</span></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="in"># - Q-Q plot : vérification de l'alignement des résidus sur la droite théorique</span></span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a><span class="in"># - Histogramme : forme globale (approximation gaussienne attendue)</span></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 2))</span></span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a><span class="in">qqnorm(res, main = "Q-Q des résidus"); qqline(res)</span></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a><span class="in">hist(res, breaks = 15, main = "Distribution des résidus", xlab = "Résidus")</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1))</span></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a><span class="in"># Test formel de normalité (Shapiro-Wilk)</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a><span class="in">shapiro_res &lt;- shapiro.test(res)</span></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="in">shapiro_res</span></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a>Les graphes de résidus indiquent une distribution globalement symétrique et proche d’une droite normale, mais le test de Shapiro–Wilk est significatif (p-value très petite), ce qui met en évidence une déviation statistique de la normalité ; compte tenu de la taille d’échantillon et de l’homogénéité des variances, l’ANOVA reste toutefois utilisable avec prudence.</span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Homogénéité des variances (Levene)</span></span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a>Le test de Levene est réalisé sur la **hauteur moyenne par combinaison (id, fertilisant, variete)**, ce qui revient à comparer les variances entre conditions expérimentales (fertilisant × variété), indépendamment de la période.</span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r levene, error=TRUE, warning=FALSE}</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a><span class="in"># Agrégation : moyenne de hauteur par id, fertilisant, variété</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a><span class="in">d_mean &lt;- d %&gt;%</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id, fertilisant, variete) %&gt;%</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(hauteur_moy = mean(hauteur, na.rm = TRUE), .groups = "drop")</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="in"># Test de Levene sur les variances de hauteur moyenne entre combinaisons fertilisant × variété</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a><span class="in">lev &lt;- car::leveneTest(hauteur_moy ~ fertilisant * variete, data = d_mean)</span></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a><span class="in"># Mise en forme d'un tableau lisible</span></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a><span class="in">lev_df &lt;- as.data.frame(lev)</span></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a><span class="in">lev_df &lt;- cbind(Source = rownames(lev_df), lev_df)</span></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(lev_df) &lt;- NULL</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a><span class="in">names(lev_df) &lt;- c("Source", "Ddl", "F", "p-value")</span></span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a><span class="in">lev_df[["p-value"]] &lt;- ifelse(is.na(lev_df[["p-value"]]), "—", format.pval(lev_df[["p-value"]], digits = 3))</span></span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a><span class="in">lev_df[["F"]] &lt;- ifelse(is.na(lev_df[["F"]]), "—", format(round(lev_df[["F"]], 4), nsmall = 4))</span></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a><span class="in">lev_df[is.na(lev_df)] &lt;- "—"</span></span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="in">  lev_df,</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a><span class="in">  align = c("l", "r", "r", "r"),</span></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété)."</span></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a>Le test de Levene n’étant pas significatif, on peut considérer que les variances de hauteur sont similaires entre les combinaisons de fertilisant et de variété.</span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparaisons post-hoc</span></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparaisons post-hoc</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a>Lorsque des effets ou interactions sont significatifs, les comparaisons deux à deux (Tukey) permettent d’identifier les combinaisons **groupe × variété** et les **périodes** dont les moyennes diffèrent significativement.</span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a><span class="fu">## Moyennes marginales (fertilisant × variété)</span></span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r emm-marginal, error=TRUE}</span></span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a><span class="in"># Moyennes marginales (effet global de fertilisant × variété, toutes périodes confondues)</span></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="in">emm_gv &lt;- emmeans(anova_rm, ~ fertilisant * variete)</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a><span class="in"># Extraction sous forme de data.frame et arrondi pour la présentation</span></span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a><span class="in">emm_gv_df &lt;- summary(emm_gv) %&gt;% as.data.frame()</span></span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a><span class="in">emm_gv_df &lt;- emm_gv_df %&gt;%</span></span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a><span class="in">    emmean   = round(emmean, 2),</span></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a><span class="in">    SE       = round(SE, 3),</span></span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a><span class="in">    lower.CL = round(lower.CL, 2),</span></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a><span class="in">    upper.CL = round(upper.CL, 2)</span></span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a><span class="in">names(emm_gv_df) &lt;- c("Fertilisant", "Variété", "Moyenne", "ESM", "Ddl", "IC inf.", "IC sup.")</span></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(</span></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a><span class="in">  emm_gv_df[, c("Fertilisant", "Variété", "Moyenne", "ESM", "IC inf.", "IC sup.")],</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a><span class="in">  align = c("l", "l", "r", "r", "r", "r"),</span></span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "Moyennes marginales (et IC 95 %) pour fertilisant × variété (toutes périodes confondues)."</span></span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a>Ces moyennes montrent que, en moyenne sur toutes les périodes, la variété&nbsp;2 produit des plantes plus hautes que la variété&nbsp;1 pour un même fertilisant, avec des valeurs maximales observées pour les combinaisons <span class="in">`Ca–Var2`</span> et <span class="in">`Ma–Var2`</span>.</span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparaisons deux à deux : fertilisant × variété (Tukey)</span></span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r posthoc-gv, error=TRUE}</span></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="in"># Comparaisons toutes paires de combinaisons fertilisant × variété (corrigées de Tukey)</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a><span class="in">ph_gv &lt;- pairs(emm_gv, adjust = "tukey") %&gt;% as.data.frame()</span></span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="in">pval &lt;- ph_gv$p.value</span></span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a><span class="in">ph_gv &lt;- ph_gv %&gt;%</span></span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a><span class="in">    estimate = round(estimate, 3),</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a><span class="in">    SE       = round(SE, 3),</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a><span class="in">    t.ratio  = round(t.ratio, 2),</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a><span class="in">    signif   = case_when(</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a><span class="in">      pval &lt; 0.001 ~ "***",</span></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a><span class="in">      pval &lt; 0.01  ~ "**",</span></span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a><span class="in">      pval &lt; 0.05  ~ "*",</span></span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE         ~ ""</span></span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a><span class="in">    p.value = format.pval(p.value, digits = 3, eps = 0.001)</span></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a><span class="in">names(ph_gv) &lt;- c("Contraste", "Différence", "ESM", "Ddl", "t", "p-value", "Signif.")</span></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a><span class="in">  ph_gv,</span></span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a><span class="in">  align = c("l", "r", "r", "r", "r", "r", "c"),</span></span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "Comparaisons post-hoc Tukey : fertilisant × variété (toutes périodes confondues). * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001."</span></span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a>Après correction de Tukey, seules les combinaisons <span class="in">`Ca–Var2`</span> vs <span class="in">`Ma–Var1`</span> et <span class="in">`Ca–Var2`</span> vs <span class="in">`An–Var1`</span> présentent des différences significatives de hauteur, ce qui confirme un avantage marqué de <span class="in">`Ca–Var2`</span> par rapport à ces deux couples.</span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparaisons deux à deux par période (Tukey)</span></span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r posthoc-periode, error=TRUE}</span></span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a><span class="in"># Effets de fertilisant × variété examinés séparément pour chaque période (T1, T2, T3, T4)</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a><span class="in">emm_per &lt;- emmeans(anova_rm, ~ fertilisant * variete | periode)</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a><span class="in">ph_per &lt;- pairs(emm_per, adjust = "tukey") %&gt;% as.data.frame()</span></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a><span class="in">pval_per &lt;- ph_per$p.value</span></span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a><span class="in">ph_per &lt;- ph_per %&gt;%</span></span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a><span class="in">    estimate = round(estimate, 3),</span></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a><span class="in">    SE       = round(SE, 3),</span></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="in">    t.ratio  = round(t.ratio, 2),</span></span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a><span class="in">    signif   = case_when(</span></span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a><span class="in">      pval_per &lt; 0.001 ~ "***",</span></span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a><span class="in">      pval_per &lt; 0.01  ~ "**",</span></span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a><span class="in">      pval_per &lt; 0.05  ~ "*",</span></span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE             ~ ""</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a><span class="in">    p.value = format.pval(p.value, digits = 3, eps = 0.001)</span></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a><span class="in">names(ph_per) &lt;- c("Contraste", "Différence", "ESM", "Ddl", "t", "p-value", "Signif.", "Période")</span></span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(</span></span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a><span class="in">  ph_per[, c("Période", "Contraste", "Différence", "ESM", "t", "p-value", "Signif.")],</span></span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a><span class="in">  align = c("l", "l", "r", "r", "r", "r", "c"),</span></span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "Comparaisons post-hoc Tukey par période. * p &lt; 0,05 ; ** p &lt; 0,01 ; *** p &lt; 0,001."</span></span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>À la période T1, plusieurs contrastes sont significatifs et indiquent un net avantage de la variété&nbsp;2 pour certains fertilisants, alors qu’aux périodes T2, T3 et T4 aucune comparaison fertilisant × variété n’est significative, ce qui suggère un rapprochement des hauteurs entre combinaisons au fil du temps.</span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modèles ANOVA à mesures répétées (structure type DABIRE)</span></span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>Dans cette section, on implémente **exactement le même type de modèles** que dans le rapport de DABIRE (ANOVA par période, puis ANOVA à mesures répétées avec <span class="in">`car::Anova`</span>), en utilisant directement les variables <span class="in">`fertilisant`</span>, <span class="in">`variete`</span>, <span class="in">`periode`</span> et <span class="in">`hauteur`</span> de la base.</span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-libs, message=FALSE, warning=FALSE}</span></span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a><span class="in">if (!requireNamespace("nortest", quietly = TRUE)) install.packages("nortest", repos = "https://cloud.r-project.org", quiet = TRUE)</span></span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a><span class="in">library(nortest)</span></span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a><span class="in">library(rstatix)</span></span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggpubr)</span></span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)</span></span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-import, error=TRUE}</span></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a><span class="in"># Import des mêmes données que précédemment</span></span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a><span class="in">d2 &lt;- read_excel("donnees/donnees.xlsx")</span></span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a><span class="in"># Conversion des virgules décimales en points et mise en forme des facteurs</span></span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a><span class="in">d2$hauteur &lt;- as.numeric(gsub(",", ".", as.character(d2$hauteur)))</span></span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a><span class="in">d2 &lt;- d2 %&gt;%</span></span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a><span class="in">    fertilisant = factor(fertilisant),               # Ma, Ca, An</span></span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a><span class="in">    variete     = factor(variete),                   # Var1, Var2</span></span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a><span class="in">    periode     = factor(periode, levels = c("T1","T2","T3","T4"))</span></span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modélisation : ANOVA par période + modèle à mesures répétées</span></span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-wide, error=TRUE}</span></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a><span class="in"># Création d'IDs artificiels par (fertilisant, variete, periode)</span></span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a><span class="in">d2_id &lt;- d2 %&gt;%</span></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(fertilisant, variete, periode) %&gt;%</span></span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(No, .by_group = TRUE) %&gt;%</span></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(rang = row_number()) %&gt;%</span></span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = interaction(fertilisant, variete, rang, drop = TRUE))</span></span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a><span class="in"># Passage au format large : une ligne = un "sujet", colonnes t1..t4</span></span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a><span class="in">base &lt;- d2_id %&gt;%</span></span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a><span class="in">    periode_mesure = dplyr::recode(</span></span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a><span class="in">      as.character(periode),</span></span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a><span class="in">      "T1" = "t1",</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a><span class="in">      "T2" = "t2",</span></span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a><span class="in">      "T3" = "t3",</span></span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a><span class="in">      "T4" = "t4"</span></span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a><span class="in">  select(id, fertilisant, variete, periode_mesure, hauteur) %&gt;%</span></span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a><span class="in">  tidyr::pivot_wider(</span></span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a><span class="in">    names_from  = periode_mesure,</span></span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a><span class="in">    values_from = hauteur</span></span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(id)</span></span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a><span class="in"># Matrice de réponses hauteur (t1..t4) et facteurs</span></span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a><span class="in">base$hauteur    &lt;- as.matrix(base[, c("t1","t2","t3","t4")])</span></span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a><span class="in">base$fertilisant &lt;- factor(base$fertilisant)</span></span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a><span class="in">base$variete     &lt;- factor(base$variete)</span></span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a><span class="in">attach(base)</span></span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Effet du fertilisant à chaque période</span></span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-anova-fert, error=TRUE}</span></span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a><span class="in">mod.hauteur.fertilisant &lt;- lm(hauteur ~ fertilisant)</span></span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a><span class="in">H_fert &lt;- summary(aov(mod.hauteur.fertilisant))</span></span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a><span class="in">H_fert</span></span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a><span class="in">LM_fert &lt;- summary(mod.hauteur.fertilisant)</span></span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a><span class="in">LM_fert</span></span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a>Ces analyses univariées montrent que l’effet du **fertilisant** sur la hauteur n’est significatif qu’à la période T3, où le fertilisant Ca donne des plantes plus hautes que le fertilisant de référence, alors qu’aux périodes T1, T2 et T4 les différences entre fertilisants ne sont pas statistiquement détectables.</span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Effet de la variété à chaque période</span></span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-anova-var, error=TRUE}</span></span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a><span class="in">mod.hauteur.variete &lt;- lm(hauteur ~ variete)</span></span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a><span class="in">H_var &lt;- summary(aov(mod.hauteur.variete))</span></span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a><span class="in">H_var</span></span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a><span class="in">LM_var &lt;- summary(mod.hauteur.variete)</span></span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a><span class="in">LM_var</span></span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a>On observe un effet très net de la **variété** à T1, où la variété&nbsp;2 produit des plantes sensiblement plus hautes que la variété&nbsp;1, alors qu’aux périodes T2, T3 et T4 les hauteurs des deux variétés deviennent statistiquement similaires.</span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Effet d’interaction variété × fertilisant à chaque période</span></span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-anova-inter, error=TRUE}</span></span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a><span class="in">mod.hauteur.interaction &lt;- lm(hauteur ~ variete * fertilisant)</span></span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a><span class="in">H_int &lt;- summary(aov(mod.hauteur.interaction))</span></span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a><span class="in">H_int</span></span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>L’interaction **variété × fertilisant** n’est significative à aucune période, ce qui suggère que, à instant donné, l’effet de la variété est globalement parallèle d’un fertilisant à l’autre.</span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Modèle global à mesures répétées avec `car::Anova`</span></span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dabire-rm, error=TRUE}</span></span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a><span class="in">fact.temps &lt;- data.frame(TEMPS = as.factor(1:4))</span></span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a><span class="in">mod.hauteur.tps.interaction &lt;- Anova(</span></span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a><span class="in">  mod.hauteur.interaction,</span></span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a><span class="in">  idata   = fact.temps,</span></span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a><span class="in">  idesign = ~ TEMPS,</span></span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a><span class="in">  type    = "III",</span></span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a><span class="in">  test    = "Wilks"</span></span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-424"><a href="#cb28-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-425"><a href="#cb28-425" aria-hidden="true" tabindex="-1"></a><span class="in">summary(mod.hauteur.tps.interaction)</span></span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a>Les tests multivariés confirment un effet global du **temps** et une interaction significative **variété × temps**, indiquant que l’écart entre variétés varie au cours des quatre mesures, tandis que les interactions impliquant le fertilisant avec le temps restent non significatives.</span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-432"><a href="#cb28-432" aria-hidden="true" tabindex="-1"></a>Cette **ANOVA à mesures répétées** (implémentée à la fois avec `afex::aov_car` et avec la structure multivariée de `car::Anova`) permet de tester si les facteurs **terreau** (`groupe` / `fertilisant`), **variété** (`variete`) et **période** (`periode` / `TEMPS`), ainsi que leurs interactions, expliquent la variable dépendante **taille**. Après vérification des hypothèses (normalité des résidus, homogénéité des variances, sphéricité et corrections associées), l’interprétation des effets significatifs et des **comparaisons post-hoc** permet d’identifier les combinaisons terreau × variété et les périodes qui conduisent aux plus fortes hauteurs de plantes.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
