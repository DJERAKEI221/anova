"0","# Agrégation : moyenne de hauteur par id, fertilisant, variété"
"0","d_mean <- d %>%"
"0","  group_by(id, fertilisant, variete) %>%"
"0","  summarise(hauteur_moy = mean(hauteur, na.rm = TRUE), .groups = ""drop"")"
"0",""
"0","# Test de Levene sur les variances de hauteur moyenne entre combinaisons fertilisant × variété"
"0","lev <- car::leveneTest(hauteur_moy ~ fertilisant * variete, data = d_mean)"
"0",""
"0","# Mise en forme d'un tableau lisible"
"0","lev_df <- as.data.frame(lev)"
"0","lev_df <- cbind(Source = rownames(lev_df), lev_df)"
"0","rownames(lev_df) <- NULL"
"0","names(lev_df) <- c(""Source"", ""Ddl"", ""F"", ""p-value"")"
"0","lev_df[[""p-value""]] <- ifelse(is.na(lev_df[[""p-value""]]), ""—"", format.pval(lev_df[[""p-value""]], digits = 3))"
"0","lev_df[[""F""]] <- ifelse(is.na(lev_df[[""F""]]), ""—"", format(round(lev_df[[""F""]], 4), nsmall = 4))"
"0","lev_df[is.na(lev_df)] <- ""—"""
"0",""
"0","knitr::kable("
"0","  lev_df,"
"0","  align = c(""l"", ""r"", ""r"", ""r""),"
"0","  caption = ""Test de Levene sur la hauteur moyenne (homogénéité des variances entre groupes de fertilisant et de variété)."""
"0",")"
